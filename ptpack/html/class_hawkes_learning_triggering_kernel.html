<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Multivariate Point Process Package: HawkesLearningTriggeringKernel Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Multivariate Point Process Package
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="class_hawkes_learning_triggering_kernel-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">HawkesLearningTriggeringKernel Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="class_hawkes_learning_triggering_kernel.html" title="HawkesLearningTriggeringKernel implements the multivariate Hawkes process where the triggering kernel...">HawkesLearningTriggeringKernel</a> implements the multivariate Hawkes process where the triggering kernel can be learned from the data.  
 <a href="class_hawkes_learning_triggering_kernel.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">include/HawkesLearningTriggeringKernel.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for HawkesLearningTriggeringKernel:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_hawkes_learning_triggering_kernel.png" usemap="#HawkesLearningTriggeringKernel_map" alt=""/>
  <map id="HawkesLearningTriggeringKernel_map" name="HawkesLearningTriggeringKernel_map">
<area href="class_i_process.html" title="IProcess defines a general interface for each specific point process. " alt="IProcess" shape="rect" coords="0,0,201,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html">OPTION</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options used to configure the fitting of the general Hawkes Process with learned triggering kernels.  <a href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ac7b5e8e9f8ee5c91ef5944c8f0aeddd4"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4">Regularizer</a> { <a class="el" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4ac83005041dc2a346351531d02576c6c3">L22</a>, 
<a class="el" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4a48cf97ed867bb5394cc8cef55704fe29">GROUP</a>, 
<a class="el" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4abbbb4b6d788f3bdcf6a5ac02563dd5bc">NONE</a>
 }<tr class="memdesc:ac7b5e8e9f8ee5c91ef5944c8f0aeddd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Supported regularizations used to fit the standard Hawkes Process.  <a href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:ac7b5e8e9f8ee5c91ef5944c8f0aeddd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da9061a716ba04c00b859310d819242"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242">RegCoef</a> { <a class="el" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242a3bc2e21be8c731ddfa1942d56fbd0044">LAMBDA0</a>, 
<a class="el" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242ad001fd91ab126b8fa63f2c0ba195083b">LAMBDA</a>
 }<tr class="memdesc:a8da9061a716ba04c00b859310d819242"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regularization coefficients.  <a href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a8da9061a716ba04c00b859310d819242"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7741e2e5667474f49af9faafebad764d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a7741e2e5667474f49af9faafebad764d">HawkesLearningTriggeringKernel</a> (const unsigned &amp;n, const unsigned &amp;num_dims, const Eigen::VectorXd &amp;tau, const Eigen::VectorXd &amp;sigma)</td></tr>
<tr class="memdesc:a7741e2e5667474f49af9faafebad764d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor.  <a href="#a7741e2e5667474f49af9faafebad764d">More...</a><br /></td></tr>
<tr class="separator:a7741e2e5667474f49af9faafebad764d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae988c2dc1a0c0453df47c6d25d58a2d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#ae988c2dc1a0c0453df47c6d25d58a2d2">HawkesLearningTriggeringKernel</a> (const unsigned &amp;n, const unsigned &amp;num_dims, const <a class="el" href="class_graph.html">Graph</a> *graph, const Eigen::VectorXd &amp;tau, const Eigen::VectorXd &amp;sigma)</td></tr>
<tr class="memdesc:ae988c2dc1a0c0453df47c6d25d58a2d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor.  <a href="#ae988c2dc1a0c0453df47c6d25d58a2d2">More...</a><br /></td></tr>
<tr class="separator:ae988c2dc1a0c0453df47c6d25d58a2d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8a5ab03bac331613507c53f3a8ad1ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#ac8a5ab03bac331613507c53f3a8ad1ed">fit</a> (const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;data, const <a class="el" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html">OPTION</a> &amp;options)</td></tr>
<tr class="memdesc:ac8a5ab03bac331613507c53f3a8ad1ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum likelihood estimation for the model parameters.  <a href="#ac8a5ab03bac331613507c53f3a8ad1ed">More...</a><br /></td></tr>
<tr class="separator:ac8a5ab03bac331613507c53f3a8ad1ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e368dd2bd271833d7f3467fd9c4ef8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#af8e368dd2bd271833d7f3467fd9c4ef8">NegLoglikelihood</a> (double &amp;objvalue, Eigen::VectorXd &amp;gradient)</td></tr>
<tr class="memdesc:af8e368dd2bd271833d7f3467fd9c4ef8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Negative loglikelihood of general Hawkes process.  <a href="#af8e368dd2bd271833d7f3467fd9c4ef8">More...</a><br /></td></tr>
<tr class="separator:af8e368dd2bd271833d7f3467fd9c4ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28fe1c003154a9a2825daa2b7c0b54bc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a28fe1c003154a9a2825daa2b7c0b54bc">Gradient</a> (const unsigned &amp;k, Eigen::VectorXd &amp;gradient)</td></tr>
<tr class="memdesc:a28fe1c003154a9a2825daa2b7c0b54bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the gradient w.r.t. the model parameters on the k-th sequence.  <a href="#a28fe1c003154a9a2825daa2b7c0b54bc">More...</a><br /></td></tr>
<tr class="separator:a28fe1c003154a9a2825daa2b7c0b54bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaadfcdb6f741c90995bf7938b9b9865"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#aeaadfcdb6f741c90995bf7938b9b9865">Intensity</a> (const double &amp;t, const <a class="el" href="class_sequence.html">Sequence</a> &amp;data, Eigen::VectorXd &amp;intensity_dim)</td></tr>
<tr class="memdesc:aeaadfcdb6f741c90995bf7938b9b9865"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the summation \(\sum_{d=1}^D\lambda^*_d(t)\) of the intensity value \(\lambda^*_d(t)\) of each dimension in a given sequence data at the time t.  <a href="#aeaadfcdb6f741c90995bf7938b9b9865">More...</a><br /></td></tr>
<tr class="separator:aeaadfcdb6f741c90995bf7938b9b9865"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a493e5da70f82c7881abbed0173e407f0"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a493e5da70f82c7881abbed0173e407f0">IntensityUpperBound</a> (const double &amp;t, const double &amp;L, const <a class="el" href="class_sequence.html">Sequence</a> &amp;data, Eigen::VectorXd &amp;intensity_upper_dim)</td></tr>
<tr class="memdesc:a493e5da70f82c7881abbed0173e407f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the upper bound of the summation of the intensity value on each dimension from time t to t + L given the history of past events in sequence data. Let \({\lambda_d^*(t)}\) be the conditional intensity function on the d-th dimension where \(d=1\dotso D\), and num_dims_ = D. This function returns </p><p class="formulaDsp">
\begin{align} \lambda_0^D(t) \geq \sum_{d=1}^D\sup_{\tau\in[t, t + \tau(t)]}\lambda^*_d(\tau), \end{align}
</p>
<p> where the returned value \(\lambda_0^D(t)\) will be used for Ogata's Thinning algorithm.  <a href="#a493e5da70f82c7881abbed0173e407f0">More...</a><br /></td></tr>
<tr class="separator:a493e5da70f82c7881abbed0173e407f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b8f84d230e3c769e18c59185d13f259"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a8b8f84d230e3c769e18c59185d13f259">IntensityIntegral</a> (const double &amp;lower, const double &amp;upper, const <a class="el" href="class_sequence.html">Sequence</a> &amp;data)</td></tr>
<tr class="memdesc:a8b8f84d230e3c769e18c59185d13f259"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the integral of the intensity function \(\int_{a}^b\lambda^*(\tau)d\tau\) where \(a = lower\) and \(b = upper\).  <a href="#a8b8f84d230e3c769e18c59185d13f259">More...</a><br /></td></tr>
<tr class="separator:a8b8f84d230e3c769e18c59185d13f259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da5147830ac380b8f115244ae6ad663"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a5da5147830ac380b8f115244ae6ad663">PredictNextEventTime</a> (const <a class="el" href="class_sequence.html">Sequence</a> &amp;data, const unsigned &amp;num_simulations)</td></tr>
<tr class="memdesc:a5da5147830ac380b8f115244ae6ad663"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict the next event timing by the expectation \(\int_{t_n}^\infty tf^*(t)dt\). Currently, we use the sample average by simulations to approximate the expectation since the conditional density \(f^*(t)\) normally does not have an analytic form.  <a href="#a5da5147830ac380b8f115244ae6ad663">More...</a><br /></td></tr>
<tr class="separator:a5da5147830ac380b8f115244ae6ad663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a526f1357573a8bd73865741941c66c41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a526f1357573a8bd73865741941c66c41">PlotTriggeringKernel</a> (const unsigned &amp;dim_m, const unsigned &amp;dim_n, const double &amp;T, const double &amp;delta)</td></tr>
<tr class="memdesc:a526f1357573a8bd73865741941c66c41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Visualize the learned triggering kernel between dimension dim_m and dimension dim_n.  <a href="#a526f1357573a8bd73865741941c66c41">More...</a><br /></td></tr>
<tr class="separator:a526f1357573a8bd73865741941c66c41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_i_process"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_i_process')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_i_process.html">IProcess</a></td></tr>
<tr class="memitem:a0b865a610181b638ac7debc95dfb1dea inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a0b865a610181b638ac7debc95dfb1dea">IProcess</a> (const unsigned &amp;n, const unsigned &amp;num_dims)</td></tr>
<tr class="memdesc:a0b865a610181b638ac7debc95dfb1dea inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor.  <a href="#a0b865a610181b638ac7debc95dfb1dea">More...</a><br /></td></tr>
<tr class="separator:a0b865a610181b638ac7debc95dfb1dea inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a0cc4820b4ee2fdf75794c6f4a18b8 inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">const Eigen::VectorXd &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a03a0cc4820b4ee2fdf75794c6f4a18b8">GetParameters</a> ()</td></tr>
<tr class="memdesc:a03a0cc4820b4ee2fdf75794c6f4a18b8 inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the column vector of model parameters.  <a href="#a03a0cc4820b4ee2fdf75794c6f4a18b8">More...</a><br /></td></tr>
<tr class="separator:a03a0cc4820b4ee2fdf75794c6f4a18b8 inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae81f873b019fbdfa20b18af706ce749c inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#ae81f873b019fbdfa20b18af706ce749c">GetNumDims</a> ()</td></tr>
<tr class="memdesc:ae81f873b019fbdfa20b18af706ce749c inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of dimensions in the process.  <a href="#ae81f873b019fbdfa20b18af706ce749c">More...</a><br /></td></tr>
<tr class="separator:ae81f873b019fbdfa20b18af706ce749c inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06fef183e9715749b20e9ed79cc3696e inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a06fef183e9715749b20e9ed79cc3696e">SetParameters</a> (const Eigen::VectorXd &amp;v)</td></tr>
<tr class="memdesc:a06fef183e9715749b20e9ed79cc3696e inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the model parameters.  <a href="#a06fef183e9715749b20e9ed79cc3696e">More...</a><br /></td></tr>
<tr class="separator:a06fef183e9715749b20e9ed79cc3696e inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7478104c50c1454e2f7559a7342c56c inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#ae7478104c50c1454e2f7559a7342c56c">PlotIntensityFunction</a> (const <a class="el" href="class_sequence.html">Sequence</a> &amp;data)</td></tr>
<tr class="memdesc:ae7478104c50c1454e2f7559a7342c56c inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plots the intensity functions based on the given sequence. It plots the intensity function and the associated event points up of each dimension in the same figure.  <a href="#ae7478104c50c1454e2f7559a7342c56c">More...</a><br /></td></tr>
<tr class="separator:ae7478104c50c1454e2f7559a7342c56c inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d234bec06e360a239e77cf3d8150a31 inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a8d234bec06e360a239e77cf3d8150a31">PlotIntensityFunction</a> (const <a class="el" href="class_sequence.html">Sequence</a> &amp;data, const unsigned &amp;dim_id)</td></tr>
<tr class="memdesc:a8d234bec06e360a239e77cf3d8150a31 inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plots the intensity function and the associated event points of the dimension dim_id.  <a href="#a8d234bec06e360a239e77cf3d8150a31">More...</a><br /></td></tr>
<tr class="separator:a8d234bec06e360a239e77cf3d8150a31 inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a78139e3d04d736fb4d42e0a3d8b4db42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a78139e3d04d736fb4d42e0a3d8b4db42">Initialize</a> (const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;data)</td></tr>
<tr class="memdesc:a78139e3d04d736fb4d42e0a3d8b4db42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the temporal features <a class="el" href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">arrayK</a> and <a class="el" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a> from the input sequences.  <a href="#a78139e3d04d736fb4d42e0a3d8b4db42">More...</a><br /></td></tr>
<tr class="separator:a78139e3d04d736fb4d42e0a3d8b4db42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5468cdc386de5aa69ff4979efef254fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a5468cdc386de5aa69ff4979efef254fb">InitializeWithGraph</a> (const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;data)</td></tr>
<tr class="memdesc:a5468cdc386de5aa69ff4979efef254fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the temporal features <a class="el" href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">arrayK</a> and <a class="el" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a> from the input sequences where the dependency structure among the dimensions is given.  <a href="#a5468cdc386de5aa69ff4979efef254fb">More...</a><br /></td></tr>
<tr class="separator:a5468cdc386de5aa69ff4979efef254fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aa5e0366f3f18c7b3035fd693abc870"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a8aa5e0366f3f18c7b3035fd693abc870">InitializeConstants</a> ()</td></tr>
<tr class="memdesc:a8aa5e0366f3f18c7b3035fd693abc870"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize all helper variables.  <a href="#a8aa5e0366f3f18c7b3035fd693abc870">More...</a><br /></td></tr>
<tr class="separator:a8aa5e0366f3f18c7b3035fd693abc870"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdb855bcf19ac24836fafe9a3bbed516"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#acdb855bcf19ac24836fafe9a3bbed516">PostProcessing</a> ()</td></tr>
<tr class="memdesc:acdb855bcf19ac24836fafe9a3bbed516"><td class="mdescLeft">&#160;</td><td class="mdescRight">Post process the learned dependency structure.  <a href="#acdb855bcf19ac24836fafe9a3bbed516">More...</a><br /></td></tr>
<tr class="separator:acdb855bcf19ac24836fafe9a3bbed516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fef0d54b228337da0b4ea429214b84c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a5fef0d54b228337da0b4ea429214b84c">GetNegLoglikelihood</a> (double &amp;objvalue, Eigen::VectorXd &amp;gradient)</td></tr>
<tr class="memdesc:a5fef0d54b228337da0b4ea429214b84c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the negative loglikelihood.  <a href="#a5fef0d54b228337da0b4ea429214b84c">More...</a><br /></td></tr>
<tr class="separator:a5fef0d54b228337da0b4ea429214b84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_class_i_process"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_class_i_process')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="class_i_process.html">IProcess</a></td></tr>
<tr class="memitem:aa099f7f40ad6e747422c9a3794cc09d2 inherit pro_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#aa099f7f40ad6e747422c9a3794cc09d2">InitializeDimension</a> (const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;data)</td></tr>
<tr class="separator:aa099f7f40ad6e747422c9a3794cc09d2 inherit pro_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a734b843e2d6eb6b5b50667f3bd96cd81"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a734b843e2d6eb6b5b50667f3bd96cd81">PI</a> = 3.14159265358979323846</td></tr>
<tr class="separator:a734b843e2d6eb6b5b50667f3bd96cd81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e8ae53b466366c77056383e392640e3"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a3e8ae53b466366c77056383e392640e3">tau_</a></td></tr>
<tr class="memdesc:a3e8ae53b466366c77056383e392640e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">A column vector of size num_rbfs_. Each component of tau_ is the location of the respective RBF basis function.  <a href="#a3e8ae53b466366c77056383e392640e3">More...</a><br /></td></tr>
<tr class="separator:a3e8ae53b466366c77056383e392640e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad62472ef09cb2f1d0b65226f316f7c0b"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a></td></tr>
<tr class="memdesc:ad62472ef09cb2f1d0b65226f316f7c0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of RBF basis functions.  <a href="#ad62472ef09cb2f1d0b65226f316f7c0b">More...</a><br /></td></tr>
<tr class="separator:ad62472ef09cb2f1d0b65226f316f7c0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73147e2652a0cf0073b74479433f97b0"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a73147e2652a0cf0073b74479433f97b0">sigma_</a></td></tr>
<tr class="memdesc:a73147e2652a0cf0073b74479433f97b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">A column vector of size num_rbfs_. Each component of sigma_ is the bandwidth of the respective RBF basis function.  <a href="#a73147e2652a0cf0073b74479433f97b0">More...</a><br /></td></tr>
<tr class="separator:a73147e2652a0cf0073b74479433f97b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad648a5fe55e922593272cf0886453c1d"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#ad648a5fe55e922593272cf0886453c1d">sqrt2sigma_</a></td></tr>
<tr class="memdesc:ad648a5fe55e922593272cf0886453c1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper variable defined as \(\sqrt{2}\)sigma_.  <a href="#ad648a5fe55e922593272cf0886453c1d">More...</a><br /></td></tr>
<tr class="separator:ad648a5fe55e922593272cf0886453c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5db00053b26ed045147bdc0f2fed488e"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a5db00053b26ed045147bdc0f2fed488e">sqrt2PIsigma_</a></td></tr>
<tr class="memdesc:a5db00053b26ed045147bdc0f2fed488e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper variable defined as \(0.5\sqrt{2\pi}\)sigma_.  <a href="#a5db00053b26ed045147bdc0f2fed488e">More...</a><br /></td></tr>
<tr class="separator:a5db00053b26ed045147bdc0f2fed488e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e4e3c7a1f9a199c0b0fddb6f26e321"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a82e4e3c7a1f9a199c0b0fddb6f26e321">erfctau_sigma_</a></td></tr>
<tr class="memdesc:a82e4e3c7a1f9a199c0b0fddb6f26e321"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper variable defined as \(\text{erfc}\bigg(\frac{tau\_}{\sqrt{2}\text{sigma_}}\bigg)\).  <a href="#a82e4e3c7a1f9a199c0b0fddb6f26e321">More...</a><br /></td></tr>
<tr class="separator:a82e4e3c7a1f9a199c0b0fddb6f26e321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c09d0ea92fdcbd7dc2564d6a105968"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::vector&lt; Eigen::MatrixXd &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">arrayK</a></td></tr>
<tr class="memdesc:ac8c09d0ea92fdcbd7dc2564d6a105968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporal features associated with the intensity function.  <a href="#ac8c09d0ea92fdcbd7dc2564d6a105968">More...</a><br /></td></tr>
<tr class="separator:ac8c09d0ea92fdcbd7dc2564d6a105968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62d13fcaf697b77b50988549f83f968b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; Eigen::MatrixXd &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a></td></tr>
<tr class="memdesc:a62d13fcaf697b77b50988549f83f968b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Temporal features derived from the integral of the intensity.  <a href="#a62d13fcaf697b77b50988549f83f968b">More...</a><br /></td></tr>
<tr class="separator:a62d13fcaf697b77b50988549f83f968b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab918453360db52ff3913d6bd1a48c88a"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#ab918453360db52ff3913d6bd1a48c88a">observation_window_T_</a></td></tr>
<tr class="memdesc:ab918453360db52ff3913d6bd1a48c88a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A column vector of length \(C\) which is the total number of sequences. Each component records the observation window in the respective sequence.  <a href="#ab918453360db52ff3913d6bd1a48c88a">More...</a><br /></td></tr>
<tr class="separator:ab918453360db52ff3913d6bd1a48c88a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab31c88ab7039ccbc0032204e952b5953"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a></td></tr>
<tr class="memdesc:ab31c88ab7039ccbc0032204e952b5953"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of observed sequences.  <a href="#ab31c88ab7039ccbc0032204e952b5953">More...</a><br /></td></tr>
<tr class="separator:ab31c88ab7039ccbc0032204e952b5953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae24d1f7cc03177e435aaddcf0d147556"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html">OPTION</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a></td></tr>
<tr class="memdesc:ae24d1f7cc03177e435aaddcf0d147556"><td class="mdescLeft">&#160;</td><td class="mdescRight">A configuration object which saves the optimization options.  <a href="#ae24d1f7cc03177e435aaddcf0d147556">More...</a><br /></td></tr>
<tr class="separator:ae24d1f7cc03177e435aaddcf0d147556"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b7c3d1158f1ebf1f57e4db533cb03e4"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_graph.html">Graph</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_learning_triggering_kernel.html#a5b7c3d1158f1ebf1f57e4db533cb03e4">graph_</a></td></tr>
<tr class="memdesc:a5b7c3d1158f1ebf1f57e4db533cb03e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">A graph object represents the dependency structure among the dimensions.  <a href="#a5b7c3d1158f1ebf1f57e4db533cb03e4">More...</a><br /></td></tr>
<tr class="separator:a5b7c3d1158f1ebf1f57e4db533cb03e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_i_process"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_i_process')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_i_process.html">IProcess</a></td></tr>
<tr class="memitem:ad472e6a7545cb935d7e9bfb59a0e551a inherit pro_attribs_class_i_process"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">parameters_</a></td></tr>
<tr class="memdesc:ad472e6a7545cb935d7e9bfb59a0e551a inherit pro_attribs_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">A column vector represents all model parameters of the process.  <a href="#ad472e6a7545cb935d7e9bfb59a0e551a">More...</a><br /></td></tr>
<tr class="separator:ad472e6a7545cb935d7e9bfb59a0e551a inherit pro_attribs_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17278704cd4ea4a6cbcf44b0f6ddb625 inherit pro_attribs_class_i_process"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a></td></tr>
<tr class="memdesc:a17278704cd4ea4a6cbcf44b0f6ddb625 inherit pro_attribs_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">The total number of dimensions of the process.  <a href="#a17278704cd4ea4a6cbcf44b0f6ddb625">More...</a><br /></td></tr>
<tr class="separator:a17278704cd4ea4a6cbcf44b0f6ddb625 inherit pro_attribs_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67e1222753e90d1f122d1234590c03ff inherit pro_attribs_class_i_process"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a67e1222753e90d1f122d1234590c03ff">all_timestamp_per_dimension_</a></td></tr>
<tr class="memdesc:a67e1222753e90d1f122d1234590c03ff inherit pro_attribs_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">all_timestamp_per_dimension_ is a 3-d array where all_timestamp_per_dimension_[c][n][i] records the i-th event on the n-th dimension in the c-th sequence.  <a href="#a67e1222753e90d1f122d1234590c03ff">More...</a><br /></td></tr>
<tr class="separator:a67e1222753e90d1f122d1234590c03ff inherit pro_attribs_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="class_hawkes_learning_triggering_kernel.html" title="HawkesLearningTriggeringKernel implements the multivariate Hawkes process where the triggering kernel...">HawkesLearningTriggeringKernel</a> implements the multivariate Hawkes process where the triggering kernel can be learned from the data. </p>
<p>A multivariate Hawkes Process is a process where the occurrence of an event to a dimension will trigger more events on this dimension and other related dimensions in the near future. The intensity function of each dimension of the Hawkes process is defined as the following: </p><p class="formulaDsp">
\begin{align} \lambda^n(t) = \lambda_0^n + \sum_{m=1}^D\sum_{t^m_j &lt; t}\gamma_{mn}(t, t^m_j), \end{align}
</p>
<p> where \(\lambda_0^n\geq 0\) is the base intensity, \(D\) is the number of dimensions, and \(\gamma_{mn}(t, t^m_j)\geq 0\) captures the extent to which an event on dimension \(m\) at the time \(t^m_j\) can trigger an event on dimension \(n\) at the time \(t\). We parametrize \(\gamma_{mn}(t, t^m_j) = \boldsymbol{k}_{mn}(t - t^m_j)^\top\boldsymbol{\alpha}_{mn}\). \(\boldsymbol{k}_{mn}(t)\) is a column vector where the \(l\)-th component is defined as \(\boldsymbol{k}_{mnl}(t)=\exp(-(\frac{\tau_l - t}{\sqrt{2}\sigma_l})^2)\), and \(\tau_l\) and \(\sigma_l\) are the parameters of the basis function. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00028">28</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a8da9061a716ba04c00b859310d819242"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242">HawkesLearningTriggeringKernel::RegCoef</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regularization coefficients. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a8da9061a716ba04c00b859310d819242a3bc2e21be8c731ddfa1942d56fbd0044"></a>LAMBDA0&#160;</td><td class="fielddoc">
<p>Regularization coefficient for \(\|\boldsymbol{\lambda}_0\|\) </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a8da9061a716ba04c00b859310d819242ad001fd91ab126b8fa63f2c0ba195083b"></a>LAMBDA&#160;</td><td class="fielddoc">
<p>Regularization coefficient for GROUP LASSO </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00055">55</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac7b5e8e9f8ee5c91ef5944c8f0aeddd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4">HawkesLearningTriggeringKernel::Regularizer</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Supported regularizations used to fit the standard Hawkes Process. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ac7b5e8e9f8ee5c91ef5944c8f0aeddd4ac83005041dc2a346351531d02576c6c3"></a>L22&#160;</td><td class="fielddoc">
<p>L22 norm \(\|\cdot\|_2^2\) </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ac7b5e8e9f8ee5c91ef5944c8f0aeddd4a48cf97ed867bb5394cc8cef55704fe29"></a>GROUP&#160;</td><td class="fielddoc">
<p>GROUP LASSO \(\sum_{m}\|\boldsymbol{\alpha}_{mn}\|_2\) </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ac7b5e8e9f8ee5c91ef5944c8f0aeddd4abbbb4b6d788f3bdcf6a5ac02563dd5bc"></a>NONE&#160;</td><td class="fielddoc">
<p>No regularization </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00036">36</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7741e2e5667474f49af9faafebad764d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HawkesLearningTriggeringKernel::HawkesLearningTriggeringKernel </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>num_dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>the number of parameters in total. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_dims</td><td>the number of dimensions in the process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tau</td><td>the location of each basis function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>the bandwidth of each basis function. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00188">188</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae988c2dc1a0c0453df47c6d25d58a2d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HawkesLearningTriggeringKernel::HawkesLearningTriggeringKernel </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>num_dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_graph.html">Graph</a> *&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>the number of parameters in total. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_dims</td><td>the number of dimensions in the process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">graph</td><td>the graph object representing the dependency structure among the dimensions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tau</td><td>the location of each basis function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>the bandwidth of each basis function. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00201">201</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ac8a5ab03bac331613507c53f3a8ad1ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesLearningTriggeringKernel::fit </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html">OPTION</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum likelihood estimation for the model parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>vectors of observed sequences. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>data structure sotring different configuration for the optimization algorithm and the respective regularizations. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00230">230</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a5fef0d54b228337da0b4ea429214b84c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesLearningTriggeringKernel::GetNegLoglikelihood </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>objvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the negative loglikelihood. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">objvalue</td><td>negative loglikelihood. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gradient</td><td>gradient of the parameters. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00268">268</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a28fe1c003154a9a2825daa2b7c0b54bc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesLearningTriggeringKernel::Gradient </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the gradient w.r.t. the model parameters on the k-th sequence. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>sequence index. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gradient</td><td>the gradient vector w.r.t. the model parameters. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_i_process.html#a7bf5acfa8aaebde465184f99f8fa5f3f">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00392">392</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a78139e3d04d736fb4d42e0a3d8b4db42"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesLearningTriggeringKernel::Initialize </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the temporal features <a class="el" href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">arrayK</a> and <a class="el" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a> from the input sequences. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>input collection of sequences </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00026">26</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a8aa5e0366f3f18c7b3035fd693abc870"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesLearningTriggeringKernel::InitializeConstants </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize all helper variables. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00013">13</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a5468cdc386de5aa69ff4979efef254fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesLearningTriggeringKernel::InitializeWithGraph </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the temporal features <a class="el" href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">arrayK</a> and <a class="el" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a> from the input sequences where the dependency structure among the dimensions is given. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>input collection of sequences </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00097">97</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aeaadfcdb6f741c90995bf7938b9b9865"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double HawkesLearningTriggeringKernel::Intensity </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>intensity_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the summation \(\sum_{d=1}^D\lambda^*_d(t)\) of the intensity value \(\lambda^*_d(t)\) of each dimension in a given sequence data at the time t. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>the given time. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>the given sequence of the past events until time t. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">intensity_dim</td><td>a column vector of size num_dims_ where each component stores the intensity value of the respetive dimension at time t given the past sequence in data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the summation of the intensity value from each dimension. </dd></dl>

<p>Implements <a class="el" href="class_i_process.html#a1a95cb173cd1382b0a2b02be40eff726">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00399">399</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a8b8f84d230e3c769e18c59185d13f259"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double HawkesLearningTriggeringKernel::IntensityIntegral </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>lower</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>upper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the integral of the intensity function \(\int_{a}^b\lambda^*(\tau)d\tau\) where \(a = lower\) and \(b = upper\). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lower</td><td>starting point of the integral. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">upper</td><td>ending point of the integral. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>sequence of past events. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>\(\int_{a}^b\lambda^*(\tau)d\tau\) where \(a = lower\) and \(b = upper\). </dd></dl>

<p>Implements <a class="el" href="class_i_process.html#a4a07c03f4627adbf5f56f1305865648a">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00413">413</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a493e5da70f82c7881abbed0173e407f0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double HawkesLearningTriggeringKernel::IntensityUpperBound </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>intensity_upper_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the upper bound of the summation of the intensity value on each dimension from time t to t + L given the history of past events in sequence data. Let \({\lambda_d^*(t)}\) be the conditional intensity function on the d-th dimension where \(d=1\dotso D\), and num_dims_ = D. This function returns </p><p class="formulaDsp">
\begin{align} \lambda_0^D(t) \geq \sum_{d=1}^D\sup_{\tau\in[t, t + \tau(t)]}\lambda^*_d(\tau), \end{align}
</p>
<p> where the returned value \(\lambda_0^D(t)\) will be used for Ogata's Thinning algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>the starting time. </td></tr>
    <tr><td class="paramname">L</td><td>the duration. </td></tr>
    <tr><td class="paramname">data</td><td>the given sequence of the past events until time t. </td></tr>
    <tr><td class="paramname">intensity_upper_dim</td><td>a column vector of size num_dims_ storing the upper bound of the intensity function on each dimension from time t to t + L. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the summation of the upper-bound of each intensity function from the respetive dimension within the interval [t, t + L]. </dd></dl>

<p>Implements <a class="el" href="class_i_process.html#ac70ce447b3cc124827737eefe526013d">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00406">406</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="af8e368dd2bd271833d7f3467fd9c4ef8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesLearningTriggeringKernel::NegLoglikelihood </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>objvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Negative loglikelihood of general Hawkes process. </p>
<p class="formulaDsp">
\begin{align} - \sum_{n=1}^D\bigg\{\frac{1}{C}\sum_{c=1}^C\bigg(\sum_{i = 1}^{n_c}\bigg(\log(\lambda^n_0 + \sum_{m=1}^D\sum_{t^m_{j,c}&lt;t^n_{i,c}}\underbrace{\boldsymbol{k}_{mn}(t^n_{i,c} - t^m_{j,c})^\top}_{\text{arrayK[n][c][i](m,:)}}\boldsymbol{\alpha}_{mn})\bigg) - T_c\lambda_0^n - \sum_{m=1}^D\sum_{t^m_{j,c} &lt; T_c}\underbrace{\int_{t^m_j}^{T_c}\boldsymbol{k}_{mn}(t - t^m_{j,c})^\top dt}_{\text{arrayG[n][c](m,:)}}\cdot\boldsymbol{\alpha}_{mn}\bigg)\bigg\}. \end{align}
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">objvalue</td><td>negative loglikelihood. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gradient</td><td>gradient of the parameters. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_i_process.html#afc330025b3eec10ffcbfbb1c658445d3">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00333">333</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a526f1357573a8bd73865741941c66c41"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesLearningTriggeringKernel::PlotTriggeringKernel </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>dim_m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>dim_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Visualize the learned triggering kernel between dimension dim_m and dimension dim_n. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dim_m</td><td>the influential dimension </td></tr>
    <tr><td class="paramname">dim_n</td><td>the influenced dimension </td></tr>
    <tr><td class="paramname">T</td><td>observation window. </td></tr>
    <tr><td class="paramname">delta</td><td>unit step size to partition the time line. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00424">424</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="acdb855bcf19ac24836fafe9a3bbed516"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesLearningTriggeringKernel::PostProcessing </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Post process the learned dependency structure. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00171">171</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a5da5147830ac380b8f115244ae6ad663"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double HawkesLearningTriggeringKernel::PredictNextEventTime </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>num_simulations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Predict the next event timing by the expectation \(\int_{t_n}^\infty tf^*(t)dt\). Currently, we use the sample average by simulations to approximate the expectation since the conditional density \(f^*(t)\) normally does not have an analytic form. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>the sequence of past events. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_simulations</td><td>number of simulations we use to calculate the sample average. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the prediction of the next event timing. </dd></dl>

<p>Implements <a class="el" href="class_i_process.html#aaf94ce20c93b91a79d4e31260ce884ed">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html#l00419">419</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a62d13fcaf697b77b50988549f83f968b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;Eigen::MatrixXd&gt; &gt; HawkesLearningTriggeringKernel::arrayG</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Temporal features derived from the integral of the intensity. </p>
<p>The log-likelihood of observing a collection of C sequences can be derived as the following: </p><p class="formulaDsp">
\begin{align} \sum_{n=1}^D\bigg\{\frac{1}{C}\sum_{c=1}^C\bigg(\sum_{i = 1}^{n_c}\bigg(\log(\lambda^n_0 + \sum_{m=1}^D\sum_{t^m_{j,c}&lt;t^n_{i,c}}\underbrace{\boldsymbol{k}_{mn}(t^n_{i,c} - t^m_{j,c})^\top}_{\text{arrayK[n][c][i](m,:)}}\boldsymbol{\alpha}_{mn})\bigg) - T_c\lambda_0^n - \sum_{m=1}^D\sum_{t^m_{j,c} &lt; T_c}\underbrace{\int_{t^m_j}^{T_c}\boldsymbol{k}_{mn}(t - t^m_{j,c})^\top dt}_{\text{arrayG[n][c](m,:)}}\cdot\boldsymbol{\alpha}_{mn}\bigg)\bigg\}. \end{align}
</p>
<p>arrayG[n][c] is a \(D\) by num_rbfs_ matrix which stores the integral of the influence from dimension \(m\) to dimension \(n\) in the sequence c. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00137">137</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac8c09d0ea92fdcbd7dc2564d6a105968"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;std::vector&lt;Eigen::MatrixXd&gt; &gt; &gt; HawkesLearningTriggeringKernel::arrayK</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Temporal features associated with the intensity function. </p>
<p>The log-likelihood of observing a collection of C sequences can be derived as the following: </p><p class="formulaDsp">
\begin{align} \sum_{n=1}^D\bigg\{\frac{1}{C}\sum_{c=1}^C\bigg(\sum_{i = 1}^{n_c}\bigg(\log(\lambda^n_0 + \sum_{m=1}^D\sum_{t^m_{j,c}&lt;t^n_{i,c}}\underbrace{\boldsymbol{k}_{mn}(t^n_{i,c} - t^m_{j,c})^\top}_{\text{arrayK[n][c][i](m,:)}}\boldsymbol{\alpha}_{mn})\bigg) - T_c\lambda_0^n - \sum_{m=1}^D\sum_{t^m_{j,c} &lt; T_c}\underbrace{\int_{t^m_j}^{T_c}\boldsymbol{k}_{mn}(t - t^m_{j,c})^\top dt}_{\text{arrayG[n][c](m,:)}}\cdot\boldsymbol{\alpha}_{mn}\bigg)\bigg\}. \end{align}
</p>
<p>arrayK[n][c][i] is a \(D\) by num_rbfs_ matrix which stores the influence from the event at the time \(t^m_{j,c}\) on dimension \(m\) to the event at the time \(t^n_{i,c}\) on dimension \(n\) in the sequence c. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00126">126</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a82e4e3c7a1f9a199c0b0fddb6f26e321"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd HawkesLearningTriggeringKernel::erfctau_sigma_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper variable defined as \(\text{erfc}\bigg(\frac{tau\_}{\sqrt{2}\text{sigma_}}\bigg)\). </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00115">115</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5b7c3d1158f1ebf1f57e4db533cb03e4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_graph.html">Graph</a>* HawkesLearningTriggeringKernel::graph_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A graph object represents the dependency structure among the dimensions. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00177">177</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad62472ef09cb2f1d0b65226f316f7c0b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned HawkesLearningTriggeringKernel::num_rbfs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of RBF basis functions. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00099">99</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab31c88ab7039ccbc0032204e952b5953"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned HawkesLearningTriggeringKernel::num_sequences_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of observed sequences. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00145">145</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab918453360db52ff3913d6bd1a48c88a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd HawkesLearningTriggeringKernel::observation_window_T_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A column vector of length \(C\) which is the total number of sequences. Each component records the observation window in the respective sequence. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00141">141</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae24d1f7cc03177e435aaddcf0d147556"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html">OPTION</a> HawkesLearningTriggeringKernel::options_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A configuration object which saves the optimization options. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00173">173</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a734b843e2d6eb6b5b50667f3bd96cd81"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double HawkesLearningTriggeringKernel::PI = 3.14159265358979323846</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00089">89</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a73147e2652a0cf0073b74479433f97b0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd HawkesLearningTriggeringKernel::sigma_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A column vector of size num_rbfs_. Each component of sigma_ is the bandwidth of the respective RBF basis function. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00103">103</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5db00053b26ed045147bdc0f2fed488e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd HawkesLearningTriggeringKernel::sqrt2PIsigma_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper variable defined as \(0.5\sqrt{2\pi}\)sigma_. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00111">111</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad648a5fe55e922593272cf0886453c1d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd HawkesLearningTriggeringKernel::sqrt2sigma_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper variable defined as \(\sqrt{2}\)sigma_. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00107">107</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a3e8ae53b466366c77056383e392640e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd HawkesLearningTriggeringKernel::tau_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A column vector of size num_rbfs_. Each component of tau_ is the location of the respective RBF basis function. </p>

<p>Definition at line <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html#l00094">94</a> of file <a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/nandu/Development/MultiVariatePointProcess/include/<a class="el" href="_hawkes_learning_triggering_kernel_8h_source.html">HawkesLearningTriggeringKernel.h</a></li>
<li>/Users/nandu/Development/MultiVariatePointProcess/src/<a class="el" href="_hawkes_learning_triggering_kernel_8cc_source.html">HawkesLearningTriggeringKernel.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
