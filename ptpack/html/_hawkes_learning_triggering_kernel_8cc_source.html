<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Multivariate Point Process Package: /Users/nandu/Development/MultiVariatePointProcess/src/HawkesLearningTriggeringKernel.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Multivariate Point Process Package
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">HawkesLearningTriggeringKernel.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_hawkes_learning_triggering_kernel_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;../include/HawkesLearningTriggeringKernel.h&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;../include/GNUPlotWrapper.h&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;../include/Utility.h&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#a8aa5e0366f3f18c7b3035fd693abc870">   13</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#a8aa5e0366f3f18c7b3035fd693abc870">HawkesLearningTriggeringKernel::InitializeConstants</a>()</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;{</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a0def0d7b6aa8cb61991ab007f077412f">base_intensity_regularizer</a> = <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4abbbb4b6d788f3bdcf6a5ac02563dd5bc">NONE</a>;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a689c1fc31e22ad87aaae1caab36d87c2">excitation_regularizer</a> = <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4abbbb4b6d788f3bdcf6a5ac02563dd5bc">NONE</a>;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a21ba87f6f9b82b541efc46bf62b36362">coefficients</a>[<a class="code" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242a3bc2e21be8c731ddfa1942d56fbd0044">LAMBDA0</a>] = 0;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a21ba87f6f9b82b541efc46bf62b36362">coefficients</a>[<a class="code" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242ad001fd91ab126b8fa63f2c0ba195083b">LAMBDA</a>] = 0;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> = <a class="code" href="class_hawkes_learning_triggering_kernel.html#a3e8ae53b466366c77056383e392640e3">tau_</a>.size();</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad648a5fe55e922593272cf0886453c1d">sqrt2sigma_</a> = sqrt(2) * <a class="code" href="class_hawkes_learning_triggering_kernel.html#a73147e2652a0cf0073b74479433f97b0">sigma_</a>.array();</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#a5db00053b26ed045147bdc0f2fed488e">sqrt2PIsigma_</a> = 0.5 * sqrt(2 * <a class="code" href="class_hawkes_learning_triggering_kernel.html#a734b843e2d6eb6b5b50667f3bd96cd81">PI</a>) * <a class="code" href="class_hawkes_learning_triggering_kernel.html#a73147e2652a0cf0073b74479433f97b0">sigma_</a>.array();</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#a82e4e3c7a1f9a199c0b0fddb6f26e321">erfctau_sigma_</a> = (<a class="code" href="class_hawkes_learning_triggering_kernel.html#a3e8ae53b466366c77056383e392640e3">tau_</a>.array() / <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad648a5fe55e922593272cf0886453c1d">sqrt2sigma_</a>.array()).unaryExpr(std::ptr_fun(erfc));</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#a78139e3d04d736fb4d42e0a3d8b4db42">   26</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#a78139e3d04d736fb4d42e0a3d8b4db42">HawkesLearningTriggeringKernel::Initialize</a>(<span class="keyword">const</span> std::vector&lt;Sequence&gt;&amp; data)</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="class_i_process.html#aa099f7f40ad6e747422c9a3794cc09d2">InitializeDimension</a>(data);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a> = data.size();</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ i)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        std::vector&lt;std::vector&lt;Eigen::MatrixXd&gt; &gt; MatrixK(<a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>, std::vector&lt;Eigen::MatrixXd&gt;());</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        std::vector&lt;Eigen::MatrixXd&gt; MatrixG(<a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>, Eigen::MatrixXd::Zero(num_dims_, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>));</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>; ++ c)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <span class="keyword">const</span> std::vector&lt;Event&gt;&amp; seq = data[c].GetEvents();</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nc = <a class="code" href="class_i_process.html#a67e1222753e90d1f122d1234590c03ff">all_timestamp_per_dimension_</a>[c][i].size();</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;            <span class="keywordflow">if</span>(nc &gt; 0) <span class="comment">// if infected</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                MatrixK[c] = std::vector&lt;Eigen::MatrixXd&gt;(nc, Eigen::MatrixXd::Zero(num_dims_, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>));</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; nc; ++ k)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; i_time = <a class="code" href="class_i_process.html#a67e1222753e90d1f122d1234590c03ff">all_timestamp_per_dimension_</a>[c][i][k];</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                    <span class="keywordflow">for</span>(std::vector&lt;Event&gt;::const_iterator i_event = seq.begin(); i_event != seq.end(); ++ i_event)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                    {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; j = i_event-&gt;DimentionID;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; j_time = i_event-&gt;time;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                        <span class="keywordflow">if</span>(j_time &lt; i_time)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                        {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                            <span class="keywordtype">double</span> deltaT_ji = i_time - j_time;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                            MatrixK[c][k].row(j) = MatrixK[c][k].row(j).array() + ((- 0.5) * (((deltaT_ji - <a class="code" href="class_hawkes_learning_triggering_kernel.html#a3e8ae53b466366c77056383e392640e3">tau_</a>.transpose().array()) / <a class="code" href="class_hawkes_learning_triggering_kernel.html#a73147e2652a0cf0073b74479433f97b0">sigma_</a>.transpose().array()).square())).exp();</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                        }<span class="keywordflow">else</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                        {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                        }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                    }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="comment">// survival terms</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                    </div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">for</span>(std::vector&lt;Event&gt;::const_iterator i_event = seq.begin(); i_event != seq.end(); ++ i_event)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; j = i_event-&gt;DimentionID;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; j_time = i_event-&gt;time;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="keywordtype">double</span> deltaT_ji = data[c].GetTimeWindow() - j_time;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                MatrixG[c].row(j) = MatrixG[c].row(j).array() + (<a class="code" href="class_hawkes_learning_triggering_kernel.html#a5db00053b26ed045147bdc0f2fed488e">sqrt2PIsigma_</a>.array() * (((<a class="code" href="class_hawkes_learning_triggering_kernel.html#a3e8ae53b466366c77056383e392640e3">tau_</a>.array() - deltaT_ji) / <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad648a5fe55e922593272cf0886453c1d">sqrt2sigma_</a>.array()).unaryExpr(std::ptr_fun(erfc)) - <a class="code" href="class_hawkes_learning_triggering_kernel.html#a82e4e3c7a1f9a199c0b0fddb6f26e321">erfctau_sigma_</a>.array())).transpose();</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            </div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">arrayK</a>.push_back(MatrixK);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <a class="code" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a>.push_back(MatrixG);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab918453360db52ff3913d6bd1a48c88a">observation_window_T_</a> = Eigen::VectorXd::Zero(<a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>; ++ c)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab918453360db52ff3913d6bd1a48c88a">observation_window_T_</a>(c) = data[c].GetTimeWindow();</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#a5468cdc386de5aa69ff4979efef254fb">   97</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#a5468cdc386de5aa69ff4979efef254fb">HawkesLearningTriggeringKernel::InitializeWithGraph</a>(<span class="keyword">const</span> std::vector&lt;Sequence&gt;&amp; data)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="class_i_process.html#aa099f7f40ad6e747422c9a3794cc09d2">InitializeDimension</a>(data);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a> = data.size();</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ i)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        std::vector&lt;std::vector&lt;Eigen::MatrixXd&gt; &gt; MatrixK(<a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>, std::vector&lt;Eigen::MatrixXd&gt;());</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        std::vector&lt;Eigen::MatrixXd&gt; MatrixG(<a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>, Eigen::MatrixXd::Zero(num_dims_, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>; ++ c)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keyword">const</span> std::vector&lt;Event&gt;&amp; seq = data[c].GetEvents();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nc = <a class="code" href="class_i_process.html#a67e1222753e90d1f122d1234590c03ff">all_timestamp_per_dimension_</a>[c][i].size();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">if</span>(nc &gt; 0) <span class="comment">// if infected</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                MatrixK[c] = std::vector&lt;Eigen::MatrixXd&gt;(nc, Eigen::MatrixXd::Zero(num_dims_, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>));</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; nc; ++ k)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; i_time = <a class="code" href="class_i_process.html#a67e1222753e90d1f122d1234590c03ff">all_timestamp_per_dimension_</a>[c][i][k];</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <span class="keywordflow">for</span>(std::vector&lt;Event&gt;::const_iterator i_event = seq.begin(); i_event != seq.end(); ++ i_event)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; j = i_event-&gt;DimentionID;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; j_time = i_event-&gt;time;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                        <span class="keywordflow">if</span>((<a class="code" href="class_hawkes_learning_triggering_kernel.html#a5b7c3d1158f1ebf1f57e4db533cb03e4">graph_</a>-&gt;<a class="code" href="class_graph.html#a1aee641ef193a893ab2833d8874ad2f5">nodes</a>[i].parents.find(j) != <a class="code" href="class_hawkes_learning_triggering_kernel.html#a5b7c3d1158f1ebf1f57e4db533cb03e4">graph_</a>-&gt;<a class="code" href="class_graph.html#a1aee641ef193a893ab2833d8874ad2f5">nodes</a>[i].parents.end()) &amp;&amp; (j_time &lt; i_time))</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                        {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                            </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                            <span class="keywordtype">double</span> deltaT_ji = i_time - j_time;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                            MatrixK[c][k].row(j) = MatrixK[c][k].row(j).array() + ((- 0.5) * (((deltaT_ji - <a class="code" href="class_hawkes_learning_triggering_kernel.html#a3e8ae53b466366c77056383e392640e3">tau_</a>.transpose().array()) / <a class="code" href="class_hawkes_learning_triggering_kernel.html#a73147e2652a0cf0073b74479433f97b0">sigma_</a>.transpose().array()).square())).exp();</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                        }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(j_time &gt;= i_time)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="comment">// survival terms</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">for</span>(std::vector&lt;Event&gt;::const_iterator i_event = seq.begin(); i_event != seq.end(); ++ i_event)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; j = i_event-&gt;DimentionID;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; j_time = i_event-&gt;time;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="class_hawkes_learning_triggering_kernel.html#a5b7c3d1158f1ebf1f57e4db533cb03e4">graph_</a>-&gt;<a class="code" href="class_graph.html#a1aee641ef193a893ab2833d8874ad2f5">nodes</a>[i].parents.find(j) != <a class="code" href="class_hawkes_learning_triggering_kernel.html#a5b7c3d1158f1ebf1f57e4db533cb03e4">graph_</a>-&gt;<a class="code" href="class_graph.html#a1aee641ef193a893ab2833d8874ad2f5">nodes</a>[i].parents.end())</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                    <span class="keywordtype">double</span> deltaT_ji = data[c].GetTimeWindow() - j_time;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    MatrixG[c].row(j) = MatrixG[c].row(j).array() + (<a class="code" href="class_hawkes_learning_triggering_kernel.html#a5db00053b26ed045147bdc0f2fed488e">sqrt2PIsigma_</a>.array() * (((<a class="code" href="class_hawkes_learning_triggering_kernel.html#a3e8ae53b466366c77056383e392640e3">tau_</a>.array() - deltaT_ji) / <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad648a5fe55e922593272cf0886453c1d">sqrt2sigma_</a>.array()).unaryExpr(std::ptr_fun(erfc)) - <a class="code" href="class_hawkes_learning_triggering_kernel.html#a82e4e3c7a1f9a199c0b0fddb6f26e321">erfctau_sigma_</a>.array())).transpose();</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">arrayK</a>.push_back(MatrixK);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a>.push_back(MatrixG);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab918453360db52ff3913d6bd1a48c88a">observation_window_T_</a> = Eigen::VectorXd::Zero(<a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>; ++ c)</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab918453360db52ff3913d6bd1a48c88a">observation_window_T_</a>(c) = data[c].GetTimeWindow();</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#acdb855bcf19ac24836fafe9a3bbed516">  171</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#acdb855bcf19ac24836fafe9a3bbed516">HawkesLearningTriggeringKernel::PostProcessing</a>()</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    Eigen::Map&lt;Eigen::VectorXd&gt; Lambda0 = Eigen::Map&lt;Eigen::VectorXd&gt;(<a class="code" href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">parameters_</a>.segment(0, <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>).data(), <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    std::cout &lt;&lt; Lambda0.transpose() &lt;&lt; std::endl;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    std::vector&lt;Eigen::Map&lt;Eigen::MatrixXd&gt; &gt; MatrixAlpha;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ i)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        MatrixAlpha.push_back(Eigen::Map&lt;Eigen::MatrixXd&gt;(<a class="code" href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">parameters_</a>.segment(num_dims_ + i * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * num_dims_, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * num_dims_).data(), <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>, <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>));</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    Eigen::MatrixXd Alpha = Eigen::MatrixXd::Zero(num_dims_, num_dims_);    </div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ i)</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    {</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        Eigen::VectorXd parents = Eigen::VectorXd::Zero(num_dims_);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>; ++ c)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            parents = parents.array() + <a class="code" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a>[i][c].array().abs().rowwise().sum();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ j)</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">if</span>(parents(j) == 0)</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                MatrixAlpha[i].col(j) = Eigen::VectorXd::Zero(<a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ j)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            Alpha(j,i) = MatrixAlpha[i].col(j).norm();</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// std::cout &lt;&lt; MatrixAlpha[i] &lt;&lt; std::endl &lt;&lt; std::endl;</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// std::cout &lt;&lt; Alpha &lt;&lt; std::endl;</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">double</span> epsilon = 5e-2;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    Eigen::VectorXd colsum = Alpha.colwise().sum();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    colsum = (colsum.array() &gt; 0).select(colsum, 1);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    Alpha = Alpha.array().rowwise() / colsum.transpose().array();</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    Alpha = (Alpha.array() &lt; epsilon).select(0, Alpha);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    Alpha = (Alpha.array() &gt;= epsilon).select(1, Alpha);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    std::cout &lt;&lt; Alpha.cast&lt;<span class="keywordtype">unsigned</span>&gt;() &lt;&lt; std::endl;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ i)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ j)</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">if</span>(Alpha.cast&lt;<span class="keywordtype">unsigned</span>&gt;()(i,j) == 0)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                MatrixAlpha[j].col(i) = Eigen::VectorXd::Zero(<a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            }</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">//  MLE esitmation of the parameters</span></div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#ac8a5ab03bac331613507c53f3a8ad1ed">  230</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac8a5ab03bac331613507c53f3a8ad1ed">HawkesLearningTriggeringKernel::fit</a>(<span class="keyword">const</span> std::vector&lt;Sequence&gt;&amp; data, <span class="keyword">const</span> <a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html">OPTION</a>&amp; options)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_hawkes_learning_triggering_kernel.html#a5b7c3d1158f1ebf1f57e4db533cb03e4">graph_</a> == NULL)</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <a class="code" href="class_hawkes_learning_triggering_kernel.html#a78139e3d04d736fb4d42e0a3d8b4db42">HawkesLearningTriggeringKernel::Initialize</a>(data);   </div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }<span class="keywordflow">else</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    {</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="class_hawkes_learning_triggering_kernel.html#a5468cdc386de5aa69ff4979efef254fb">HawkesLearningTriggeringKernel::InitializeWithGraph</a>(data);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a> = options;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    </div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="class_optimizer.html">Optimizer</a> opt(<span class="keyword">this</span>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a689c1fc31e22ad87aaae1caab36d87c2">excitation_regularizer</a>)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4a48cf97ed867bb5394cc8cef55704fe29">GROUP</a> :</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            opt.<a class="code" href="class_optimizer.html#a59ec2deea051fd6b93aa4977026de0f1">ProximalGroupLassoForHawkes</a>(1e-2, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a21ba87f6f9b82b541efc46bf62b36362">coefficients</a>[<a class="code" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242ad001fd91ab126b8fa63f2c0ba195083b">LAMBDA</a>], 1000, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="comment">// break;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">default</span> :           </div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            opt.<a class="code" href="class_optimizer.html#a84deb39a5a55aa86ab2b3d3b2d9dda78">PLBFGS</a>(0, 1e10);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_hawkes_learning_triggering_kernel.html#a5b7c3d1158f1ebf1f57e4db533cb03e4">graph_</a> == NULL)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="class_hawkes_learning_triggering_kernel.html#acdb855bcf19ac24836fafe9a3bbed516">HawkesLearningTriggeringKernel::PostProcessing</a>();</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#a5fef0d54b228337da0b4ea429214b84c">  268</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#a5fef0d54b228337da0b4ea429214b84c">HawkesLearningTriggeringKernel::GetNegLoglikelihood</a>(<span class="keywordtype">double</span>&amp; objvalue, Eigen::VectorXd&amp; gradient)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    gradient = Eigen::VectorXd::Zero(<a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a> + <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a> * <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    Eigen::Map&lt;Eigen::VectorXd&gt; Lambda0_ = Eigen::Map&lt;Eigen::VectorXd&gt;(<a class="code" href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">parameters_</a>.segment(0, num_dims_).data(), <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    </div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    Eigen::Map&lt;Eigen::VectorXd&gt; grad_lambda0_vector = Eigen::Map&lt;Eigen::VectorXd&gt;(gradient.segment(0, num_dims_).data(), <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    std::vector&lt;Eigen::Map&lt;Eigen::MatrixXd&gt; &gt; MatrixAlpha;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ i)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        MatrixAlpha.push_back(Eigen::Map&lt;Eigen::MatrixXd&gt;(<a class="code" href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">parameters_</a>.segment(num_dims_ + i * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * num_dims_, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * num_dims_).data(), <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>, <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>));</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    std::vector&lt;Eigen::Map&lt;Eigen::MatrixXd&gt; &gt; GradMatrixAlpha;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ i)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        GradMatrixAlpha.push_back(Eigen::Map&lt;Eigen::MatrixXd&gt;(gradient.segment(num_dims_ + i * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * num_dims_, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * num_dims_).data(), <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>, <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>));</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    objvalue = 0;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ i)</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordtype">double</span> local_obj = 0;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> c = 0; c &lt; <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>; ++ c)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; nc = <a class="code" href="class_i_process.html#a67e1222753e90d1f122d1234590c03ff">all_timestamp_per_dimension_</a>[c][i].size();</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; nc; ++ k)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordtype">double</span> intensity_ck = Lambda0_(i) + (<a class="code" href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">arrayK</a>[i][c][k] * MatrixAlpha[i]).trace() + 1e-4;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                GradMatrixAlpha[i] = GradMatrixAlpha[i].array() + <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">arrayK</a>[i][c][k].transpose().array() / intensity_ck;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                grad_lambda0_vector(i) += (1 / intensity_ck);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                local_obj += log(intensity_ck);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        </div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="comment">// survival terms</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            GradMatrixAlpha[i] = GradMatrixAlpha[i].array() - <a class="code" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a>[i][c].transpose().array();</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            local_obj -= (<a class="code" href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">arrayG</a>[i][c] * MatrixAlpha[i]).trace();</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            grad_lambda0_vector(i) -= <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab918453360db52ff3913d6bd1a48c88a">observation_window_T_</a>(c);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            local_obj -= <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab918453360db52ff3913d6bd1a48c88a">observation_window_T_</a>(c) * Lambda0_(i);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        objvalue += local_obj;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    gradient = -gradient.array() / <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    objvalue = -objvalue / <a class="code" href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">num_sequences_</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">//  This virtual function requires process-specific implementation. It calculates the negative loglikelihood of the given data. This function must be called after the Initialize method to return the negative loglikelihood of the data with respect to the current parameters. </span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">//  The returned negative loglikelihood is stored in the variable objvalue;</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">//  The returned gradient vector wrt the current parameters is stored in the variable Gradient; </span></div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#af8e368dd2bd271833d7f3467fd9c4ef8">  333</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#af8e368dd2bd271833d7f3467fd9c4ef8">HawkesLearningTriggeringKernel::NegLoglikelihood</a>(<span class="keywordtype">double</span>&amp; objvalue, Eigen::VectorXd&amp; gradient)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_i_process.html#a67e1222753e90d1f122d1234590c03ff">all_timestamp_per_dimension_</a>.size() == 0)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Process is uninitialzed with any data.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="class_hawkes_learning_triggering_kernel.html#a5fef0d54b228337da0b4ea429214b84c">HawkesLearningTriggeringKernel::GetNegLoglikelihood</a>(objvalue, gradient);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    Eigen::Map&lt;Eigen::VectorXd&gt; Lambda0_ = Eigen::Map&lt;Eigen::VectorXd&gt;(<a class="code" href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">parameters_</a>.segment(0, <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>).data(), <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    Eigen::Map&lt;Eigen::VectorXd&gt; grad_lambda0_vector = Eigen::Map&lt;Eigen::VectorXd&gt;(gradient.segment(0, <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>).data(), <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// Regularization for base intensity</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a0def0d7b6aa8cb61991ab007f077412f">base_intensity_regularizer</a>)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4ac83005041dc2a346351531d02576c6c3">L22</a> :</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            grad_lambda0_vector = grad_lambda0_vector.array() + (<a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a21ba87f6f9b82b541efc46bf62b36362">coefficients</a>[<a class="code" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242a3bc2e21be8c731ddfa1942d56fbd0044">LAMBDA0</a>] * Lambda0_.array());</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            objvalue = objvalue + 0.5 * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a21ba87f6f9b82b541efc46bf62b36362">coefficients</a>[<a class="code" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242a3bc2e21be8c731ddfa1942d56fbd0044">LAMBDA0</a>] * Lambda0_.squaredNorm();</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            </div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4abbbb4b6d788f3bdcf6a5ac02563dd5bc">NONE</a> :</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordflow">break</span>;  </div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// Regularization for excitation matrix</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    Eigen::Map&lt;Eigen::VectorXd&gt; grad_alpha_vector = Eigen::Map&lt;Eigen::VectorXd&gt;(gradient.segment(<a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>, <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a> * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>).data(), num_dims_ * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    Eigen::Map&lt;Eigen::VectorXd&gt; alpha_vector = Eigen::Map&lt;Eigen::VectorXd&gt;(<a class="code" href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">parameters_</a>.segment(num_dims_, num_dims_ * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * num_dims_).data(), num_dims_ * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// Regularization for excitation matrix</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a689c1fc31e22ad87aaae1caab36d87c2">excitation_regularizer</a>)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4ac83005041dc2a346351531d02576c6c3">L22</a> :</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            grad_alpha_vector = grad_alpha_vector.array() + <a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a21ba87f6f9b82b541efc46bf62b36362">coefficients</a>[<a class="code" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242ad001fd91ab126b8fa63f2c0ba195083b">LAMBDA</a>] * alpha_vector.array();</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            objvalue = objvalue + 0.5 * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">options_</a>.<a class="code" href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a21ba87f6f9b82b541efc46bf62b36362">coefficients</a>[<a class="code" href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242ad001fd91ab126b8fa63f2c0ba195083b">LAMBDA</a>] * alpha_vector.squaredNorm();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4abbbb4b6d788f3bdcf6a5ac02563dd5bc">NONE</a> :</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">default</span> :</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">//  Return the stochastic gradient on the random sample k.</span></div><div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#a28fe1c003154a9a2825daa2b7c0b54bc">  392</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#a28fe1c003154a9a2825daa2b7c0b54bc">HawkesLearningTriggeringKernel::Gradient</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;k, Eigen::VectorXd&amp; gradient)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">//  This virtual function requires process-specific implementation. It returns the intensity value on each dimension in the variable intensity_dim for the given sequence stored in data and the given time t;</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">//  This function returns the summation of the individual intensity function on all dimensions. </span></div><div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#aeaadfcdb6f741c90995bf7938b9b9865">  399</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#aeaadfcdb6f741c90995bf7938b9b9865">HawkesLearningTriggeringKernel::Intensity</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; t, <span class="keyword">const</span> <a class="code" href="class_sequence.html">Sequence</a>&amp; data, Eigen::VectorXd&amp; intensity_dim)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;{</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">//  This virtual function requires process-specific implementation. It returns the upper bound of the intensity function on each dimension at time t given the history data in the variable intensity_upper_dim;</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">//  This function returns the summation of the individual intensity upper bound on all dimensions. </span></div><div class="line"><a name="l00406"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#a493e5da70f82c7881abbed0173e407f0">  406</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#a493e5da70f82c7881abbed0173e407f0">HawkesLearningTriggeringKernel::IntensityUpperBound</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; t, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; L, <span class="keyword">const</span> <a class="code" href="class_sequence.html">Sequence</a>&amp; data, Eigen::VectorXd&amp; intensity_upper_dim)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;{</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;}</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">//  This virtual function requires process-specific implementation. It returns the upper bound of the intensity function on each dimension at time t given the history data in the variable intensity_upper_dim;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">//  This function returns the integral of the intensity from a to b</span></div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#a8b8f84d230e3c769e18c59185d13f259">  413</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#a8b8f84d230e3c769e18c59185d13f259">HawkesLearningTriggeringKernel::IntensityIntegral</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; lower, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; upper, <span class="keyword">const</span> <a class="code" href="class_sequence.html">Sequence</a>&amp; data)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;{</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">//  This function predicts the next event by simulation;</span></div><div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#a5da5147830ac380b8f115244ae6ad663">  419</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#a5da5147830ac380b8f115244ae6ad663">HawkesLearningTriggeringKernel::PredictNextEventTime</a>(<span class="keyword">const</span> <a class="code" href="class_sequence.html">Sequence</a>&amp; data, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; num_simulations)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="class_hawkes_learning_triggering_kernel.html#a526f1357573a8bd73865741941c66c41">  424</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_hawkes_learning_triggering_kernel.html#a526f1357573a8bd73865741941c66c41">HawkesLearningTriggeringKernel::PlotTriggeringKernel</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; dim_m, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; dim_n, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; T, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; delta)</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;{</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">unsigned</span> num_points = T / delta;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    Eigen::VectorXd x = Eigen::VectorXd::LinSpaced(num_points, 0, T);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    Eigen::VectorXd y = Eigen::VectorXd::Zero(num_points);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    std::vector&lt;Eigen::Map&lt;Eigen::MatrixXd&gt; &gt; MatrixAlpha;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>; ++ i)</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        MatrixAlpha.push_back(Eigen::Map&lt;Eigen::MatrixXd&gt;(<a class="code" href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">parameters_</a>.segment(num_dims_ + i * <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * num_dims_, <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a> * num_dims_).data(), <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">num_rbfs_</a>, <a class="code" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a>));</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; num_points; ++ i)</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        y(i) = ((-((x(i) - <a class="code" href="class_hawkes_learning_triggering_kernel.html#a3e8ae53b466366c77056383e392640e3">tau_</a>.array()) / <a class="code" href="class_hawkes_learning_triggering_kernel.html#ad648a5fe55e922593272cf0886453c1d">sqrt2sigma_</a>.array()).square()).exp()).matrix().transpose() * MatrixAlpha[dim_n].col(dim_m);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    std::vector&lt;double&gt; gp_x(num_points,0);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    std::vector&lt;double&gt; gp_y(num_points,0);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; num_points; ++ i)</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        gp_x[i] = x(i);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        gp_y[i] = y(i);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    </div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="class_plot.html">Plot</a> plot(<span class="stringliteral">&quot;wxt size 640, 400&quot;</span>,<span class="stringliteral">&quot;time&quot;</span>, <span class="stringliteral">&quot;intensity&quot;</span>);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    plot.<a class="code" href="class_plot.html#aea37d945db6743c2a5505bdb4e913950">PlotScatterLine</a>(gp_x, gp_y, <span class="stringliteral">&quot;TriggeringKernel&quot;</span>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    </div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div><div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a8da9061a716ba04c00b859310d819242ad001fd91ab126b8fa63f2c0ba195083b"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242ad001fd91ab126b8fa63f2c0ba195083b">HawkesLearningTriggeringKernel::LAMBDA</a></div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00065">HawkesLearningTriggeringKernel.h:65</a></div></div>
<div class="ttc" id="class_sequence_html"><div class="ttname"><a href="class_sequence.html">Sequence</a></div><div class="ttdoc">Sequence encapsulates the operations on a sequence of events. </div><div class="ttdef"><b>Definition:</b> <a href="_sequence_8h_source.html#l00016">Sequence.h:16</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a8aa5e0366f3f18c7b3035fd693abc870"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a8aa5e0366f3f18c7b3035fd693abc870">HawkesLearningTriggeringKernel::InitializeConstants</a></div><div class="ttdeci">void InitializeConstants()</div><div class="ttdoc">Initialize all helper variables. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00013">HawkesLearningTriggeringKernel.cc:13</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ac8a5ab03bac331613507c53f3a8ad1ed"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ac8a5ab03bac331613507c53f3a8ad1ed">HawkesLearningTriggeringKernel::fit</a></div><div class="ttdeci">void fit(const std::vector&lt; Sequence &gt; &amp;data, const OPTION &amp;options)</div><div class="ttdoc">Maximum likelihood estimation for the model parameters. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00230">HawkesLearningTriggeringKernel.cc:230</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a734b843e2d6eb6b5b50667f3bd96cd81"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a734b843e2d6eb6b5b50667f3bd96cd81">HawkesLearningTriggeringKernel::PI</a></div><div class="ttdeci">const double PI</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00089">HawkesLearningTriggeringKernel.h:89</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a3e8ae53b466366c77056383e392640e3"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a3e8ae53b466366c77056383e392640e3">HawkesLearningTriggeringKernel::tau_</a></div><div class="ttdeci">Eigen::VectorXd tau_</div><div class="ttdoc">A column vector of size num_rbfs_. Each component of tau_ is the location of the respective RBF basis...</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00094">HawkesLearningTriggeringKernel.h:94</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ad648a5fe55e922593272cf0886453c1d"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ad648a5fe55e922593272cf0886453c1d">HawkesLearningTriggeringKernel::sqrt2sigma_</a></div><div class="ttdeci">Eigen::VectorXd sqrt2sigma_</div><div class="ttdoc">Helper variable defined as sigma_. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00107">HawkesLearningTriggeringKernel.h:107</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a5da5147830ac380b8f115244ae6ad663"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a5da5147830ac380b8f115244ae6ad663">HawkesLearningTriggeringKernel::PredictNextEventTime</a></div><div class="ttdeci">virtual double PredictNextEventTime(const Sequence &amp;data, const unsigned &amp;num_simulations)</div><div class="ttdoc">Predict the next event timing by the expectation . Currently, we use the sample average by simulation...</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00419">HawkesLearningTriggeringKernel.cc:419</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a62d13fcaf697b77b50988549f83f968b"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a62d13fcaf697b77b50988549f83f968b">HawkesLearningTriggeringKernel::arrayG</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Eigen::MatrixXd &gt; &gt; arrayG</div><div class="ttdoc">Temporal features derived from the integral of the intensity. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00137">HawkesLearningTriggeringKernel.h:137</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_af8e368dd2bd271833d7f3467fd9c4ef8"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#af8e368dd2bd271833d7f3467fd9c4ef8">HawkesLearningTriggeringKernel::NegLoglikelihood</a></div><div class="ttdeci">virtual void NegLoglikelihood(double &amp;objvalue, Eigen::VectorXd &amp;gradient)</div><div class="ttdoc">Negative loglikelihood of general Hawkes process. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00333">HawkesLearningTriggeringKernel.cc:333</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ac7b5e8e9f8ee5c91ef5944c8f0aeddd4ac83005041dc2a346351531d02576c6c3"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4ac83005041dc2a346351531d02576c6c3">HawkesLearningTriggeringKernel::L22</a></div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00040">HawkesLearningTriggeringKernel.h:40</a></div></div>
<div class="ttc" id="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n_html_a689c1fc31e22ad87aaae1caab36d87c2"><div class="ttname"><a href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a689c1fc31e22ad87aaae1caab36d87c2">HawkesLearningTriggeringKernel::OPTION::excitation_regularizer</a></div><div class="ttdeci">Regularizer excitation_regularizer</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00080">HawkesLearningTriggeringKernel.h:80</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_aeaadfcdb6f741c90995bf7938b9b9865"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#aeaadfcdb6f741c90995bf7938b9b9865">HawkesLearningTriggeringKernel::Intensity</a></div><div class="ttdeci">virtual double Intensity(const double &amp;t, const Sequence &amp;data, Eigen::VectorXd &amp;intensity_dim)</div><div class="ttdoc">Returns the summation  of the intensity value  of each dimension in a given sequence data at the time...</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00399">HawkesLearningTriggeringKernel.cc:399</a></div></div>
<div class="ttc" id="class_optimizer_html"><div class="ttname"><a href="class_optimizer.html">Optimizer</a></div><div class="ttdoc">Optimizer encapsulates a collection of optimization algorithms used in the toolbox. </div><div class="ttdef"><b>Definition:</b> <a href="_optimizer_8h_source.html#l00017">Optimizer.h:17</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a28fe1c003154a9a2825daa2b7c0b54bc"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a28fe1c003154a9a2825daa2b7c0b54bc">HawkesLearningTriggeringKernel::Gradient</a></div><div class="ttdeci">virtual void Gradient(const unsigned &amp;k, Eigen::VectorXd &amp;gradient)</div><div class="ttdoc">Returns the gradient w.r.t. the model parameters on the k-th sequence. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00392">HawkesLearningTriggeringKernel.cc:392</a></div></div>
<div class="ttc" id="class_graph_html_a1aee641ef193a893ab2833d8874ad2f5"><div class="ttname"><a href="class_graph.html#a1aee641ef193a893ab2833d8874ad2f5">Graph::nodes</a></div><div class="ttdeci">std::vector&lt; Node &gt; nodes</div><div class="ttdoc">The set of nodes of the given diffusion network. </div><div class="ttdef"><b>Definition:</b> <a href="_graph_8h_source.html#l00071">Graph.h:71</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ac7b5e8e9f8ee5c91ef5944c8f0aeddd4abbbb4b6d788f3bdcf6a5ac02563dd5bc"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4abbbb4b6d788f3bdcf6a5ac02563dd5bc">HawkesLearningTriggeringKernel::NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00049">HawkesLearningTriggeringKernel.h:49</a></div></div>
<div class="ttc" id="class_i_process_html_a17278704cd4ea4a6cbcf44b0f6ddb625"><div class="ttname"><a href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">IProcess::num_dims_</a></div><div class="ttdeci">unsigned num_dims_</div><div class="ttdoc">The total number of dimensions of the process. </div><div class="ttdef"><b>Definition:</b> <a href="_process_8h_source.html#l00033">Process.h:33</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a5468cdc386de5aa69ff4979efef254fb"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a5468cdc386de5aa69ff4979efef254fb">HawkesLearningTriggeringKernel::InitializeWithGraph</a></div><div class="ttdeci">void InitializeWithGraph(const std::vector&lt; Sequence &gt; &amp;data)</div><div class="ttdoc">Initialize the temporal features arrayK and arrayG from the input sequences where the dependency stru...</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00097">HawkesLearningTriggeringKernel.cc:97</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a5db00053b26ed045147bdc0f2fed488e"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a5db00053b26ed045147bdc0f2fed488e">HawkesLearningTriggeringKernel::sqrt2PIsigma_</a></div><div class="ttdeci">Eigen::VectorXd sqrt2PIsigma_</div><div class="ttdoc">Helper variable defined as sigma_. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00111">HawkesLearningTriggeringKernel.h:111</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ae24d1f7cc03177e435aaddcf0d147556"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ae24d1f7cc03177e435aaddcf0d147556">HawkesLearningTriggeringKernel::options_</a></div><div class="ttdeci">OPTION options_</div><div class="ttdoc">A configuration object which saves the optimization options. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00173">HawkesLearningTriggeringKernel.h:173</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ab31c88ab7039ccbc0032204e952b5953"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ab31c88ab7039ccbc0032204e952b5953">HawkesLearningTriggeringKernel::num_sequences_</a></div><div class="ttdeci">unsigned num_sequences_</div><div class="ttdoc">Total number of observed sequences. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00145">HawkesLearningTriggeringKernel.h:145</a></div></div>
<div class="ttc" id="class_i_process_html_aa099f7f40ad6e747422c9a3794cc09d2"><div class="ttname"><a href="class_i_process.html#aa099f7f40ad6e747422c9a3794cc09d2">IProcess::InitializeDimension</a></div><div class="ttdeci">void InitializeDimension(const std::vector&lt; Sequence &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="_process_8cc_source.html#l00008">Process.cc:8</a></div></div>
<div class="ttc" id="class_plot_html_aea37d945db6743c2a5505bdb4e913950"><div class="ttname"><a href="class_plot.html#aea37d945db6743c2a5505bdb4e913950">Plot::PlotScatterLine</a></div><div class="ttdeci">void PlotScatterLine(const std::vector&lt; double &gt; &amp;gp_x, const std::vector&lt; double &gt; &amp;gp_y, const std::string &amp;line_title)</div><div class="ttdoc">Plot lines. </div><div class="ttdef"><b>Definition:</b> <a href="_g_n_u_plot_wrapper_8cc_source.html#l00049">GNUPlotWrapper.cc:49</a></div></div>
<div class="ttc" id="class_i_process_html_ad472e6a7545cb935d7e9bfb59a0e551a"><div class="ttname"><a href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">IProcess::parameters_</a></div><div class="ttdeci">Eigen::VectorXd parameters_</div><div class="ttdoc">A column vector represents all model parameters of the process. </div><div class="ttdef"><b>Definition:</b> <a href="_process_8h_source.html#l00028">Process.h:28</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a73147e2652a0cf0073b74479433f97b0"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a73147e2652a0cf0073b74479433f97b0">HawkesLearningTriggeringKernel::sigma_</a></div><div class="ttdeci">Eigen::VectorXd sigma_</div><div class="ttdoc">A column vector of size num_rbfs_. Each component of sigma_ is the bandwidth of the respective RBF ba...</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00103">HawkesLearningTriggeringKernel.h:103</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a8b8f84d230e3c769e18c59185d13f259"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a8b8f84d230e3c769e18c59185d13f259">HawkesLearningTriggeringKernel::IntensityIntegral</a></div><div class="ttdeci">virtual double IntensityIntegral(const double &amp;lower, const double &amp;upper, const Sequence &amp;data)</div><div class="ttdoc">Returns the integral of the intensity function  where  and . </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00413">HawkesLearningTriggeringKernel.cc:413</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ad62472ef09cb2f1d0b65226f316f7c0b"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ad62472ef09cb2f1d0b65226f316f7c0b">HawkesLearningTriggeringKernel::num_rbfs_</a></div><div class="ttdeci">unsigned num_rbfs_</div><div class="ttdoc">Total number of RBF basis functions. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00099">HawkesLearningTriggeringKernel.h:99</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a5fef0d54b228337da0b4ea429214b84c"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a5fef0d54b228337da0b4ea429214b84c">HawkesLearningTriggeringKernel::GetNegLoglikelihood</a></div><div class="ttdeci">void GetNegLoglikelihood(double &amp;objvalue, Eigen::VectorXd &amp;gradient)</div><div class="ttdoc">Compute the negative loglikelihood. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00268">HawkesLearningTriggeringKernel.cc:268</a></div></div>
<div class="ttc" id="class_optimizer_html_a84deb39a5a55aa86ab2b3d3b2d9dda78"><div class="ttname"><a href="class_optimizer.html#a84deb39a5a55aa86ab2b3d3b2d9dda78">Optimizer::PLBFGS</a></div><div class="ttdeci">void PLBFGS(const double &amp;LB, const double &amp;UB)</div><div class="ttdoc">Projected LBFGS. </div><div class="ttdef"><b>Definition:</b> <a href="_optimizer_8cc_source.html#l00230">Optimizer.cc:230</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ac7b5e8e9f8ee5c91ef5944c8f0aeddd4a48cf97ed867bb5394cc8cef55704fe29"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ac7b5e8e9f8ee5c91ef5944c8f0aeddd4a48cf97ed867bb5394cc8cef55704fe29">HawkesLearningTriggeringKernel::GROUP</a></div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00045">HawkesLearningTriggeringKernel.h:45</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a82e4e3c7a1f9a199c0b0fddb6f26e321"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a82e4e3c7a1f9a199c0b0fddb6f26e321">HawkesLearningTriggeringKernel::erfctau_sigma_</a></div><div class="ttdeci">Eigen::VectorXd erfctau_sigma_</div><div class="ttdoc">Helper variable defined as . </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00115">HawkesLearningTriggeringKernel.h:115</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a8da9061a716ba04c00b859310d819242a3bc2e21be8c731ddfa1942d56fbd0044"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a8da9061a716ba04c00b859310d819242a3bc2e21be8c731ddfa1942d56fbd0044">HawkesLearningTriggeringKernel::LAMBDA0</a></div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00060">HawkesLearningTriggeringKernel.h:60</a></div></div>
<div class="ttc" id="class_plot_html"><div class="ttname"><a href="class_plot.html">Plot</a></div><div class="ttdoc">Plot is a wrapper of the GNU plot. </div><div class="ttdef"><b>Definition:</b> <a href="_g_n_u_plot_wrapper_8h_source.html#l00015">GNUPlotWrapper.h:15</a></div></div>
<div class="ttc" id="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n_html"><div class="ttname"><a href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html">HawkesLearningTriggeringKernel::OPTION</a></div><div class="ttdoc">Options used to configure the fitting of the general Hawkes Process with learned triggering kernels...</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00071">HawkesLearningTriggeringKernel.h:71</a></div></div>
<div class="ttc" id="class_i_process_html_a67e1222753e90d1f122d1234590c03ff"><div class="ttname"><a href="class_i_process.html#a67e1222753e90d1f122d1234590c03ff">IProcess::all_timestamp_per_dimension_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; all_timestamp_per_dimension_</div><div class="ttdoc">all_timestamp_per_dimension_ is a 3-d array where all_timestamp_per_dimension_[c][n][i] records the i...</div><div class="ttdef"><b>Definition:</b> <a href="_process_8h_source.html#l00038">Process.h:38</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a5b7c3d1158f1ebf1f57e4db533cb03e4"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a5b7c3d1158f1ebf1f57e4db533cb03e4">HawkesLearningTriggeringKernel::graph_</a></div><div class="ttdeci">const Graph * graph_</div><div class="ttdoc">A graph object represents the dependency structure among the dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00177">HawkesLearningTriggeringKernel.h:177</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ac8c09d0ea92fdcbd7dc2564d6a105968"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ac8c09d0ea92fdcbd7dc2564d6a105968">HawkesLearningTriggeringKernel::arrayK</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::vector&lt; Eigen::MatrixXd &gt; &gt; &gt; arrayK</div><div class="ttdoc">Temporal features associated with the intensity function. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00126">HawkesLearningTriggeringKernel.h:126</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_acdb855bcf19ac24836fafe9a3bbed516"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#acdb855bcf19ac24836fafe9a3bbed516">HawkesLearningTriggeringKernel::PostProcessing</a></div><div class="ttdeci">void PostProcessing()</div><div class="ttdoc">Post process the learned dependency structure. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00171">HawkesLearningTriggeringKernel.cc:171</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a526f1357573a8bd73865741941c66c41"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a526f1357573a8bd73865741941c66c41">HawkesLearningTriggeringKernel::PlotTriggeringKernel</a></div><div class="ttdeci">void PlotTriggeringKernel(const unsigned &amp;dim_m, const unsigned &amp;dim_n, const double &amp;T, const double &amp;delta)</div><div class="ttdoc">Visualize the learned triggering kernel between dimension dim_m and dimension dim_n. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00424">HawkesLearningTriggeringKernel.cc:424</a></div></div>
<div class="ttc" id="class_optimizer_html_a59ec2deea051fd6b93aa4977026de0f1"><div class="ttname"><a href="class_optimizer.html#a59ec2deea051fd6b93aa4977026de0f1">Optimizer::ProximalGroupLassoForHawkes</a></div><div class="ttdeci">void ProximalGroupLassoForHawkes(const double &amp;gamma0, const double &amp;lambda, const unsigned &amp;ini_max_iter, const unsigned &amp;group_size)</div><div class="ttdoc">Proximal method with group lasso type of regularization for fitting Hawkes processes. </div><div class="ttdef"><b>Definition:</b> <a href="_optimizer_8cc_source.html#l00579">Optimizer.cc:579</a></div></div>
<div class="ttc" id="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n_html_a21ba87f6f9b82b541efc46bf62b36362"><div class="ttname"><a href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a21ba87f6f9b82b541efc46bf62b36362">HawkesLearningTriggeringKernel::OPTION::coefficients</a></div><div class="ttdeci">std::map&lt; RegCoef, double &gt; coefficients</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00084">HawkesLearningTriggeringKernel.h:84</a></div></div>
<div class="ttc" id="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n_html_a0def0d7b6aa8cb61991ab007f077412f"><div class="ttname"><a href="struct_hawkes_learning_triggering_kernel_1_1_o_p_t_i_o_n.html#a0def0d7b6aa8cb61991ab007f077412f">HawkesLearningTriggeringKernel::OPTION::base_intensity_regularizer</a></div><div class="ttdeci">Regularizer base_intensity_regularizer</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00076">HawkesLearningTriggeringKernel.h:76</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_ab918453360db52ff3913d6bd1a48c88a"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#ab918453360db52ff3913d6bd1a48c88a">HawkesLearningTriggeringKernel::observation_window_T_</a></div><div class="ttdeci">Eigen::VectorXd observation_window_T_</div><div class="ttdoc">A column vector of length  which is the total number of sequences. Each component records the observa...</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8h_source.html#l00141">HawkesLearningTriggeringKernel.h:141</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a493e5da70f82c7881abbed0173e407f0"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a493e5da70f82c7881abbed0173e407f0">HawkesLearningTriggeringKernel::IntensityUpperBound</a></div><div class="ttdeci">virtual double IntensityUpperBound(const double &amp;t, const double &amp;L, const Sequence &amp;data, Eigen::VectorXd &amp;intensity_upper_dim)</div><div class="ttdoc">Returns the upper bound of the summation of the intensity value on each dimension from time t to t + ...</div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00406">HawkesLearningTriggeringKernel.cc:406</a></div></div>
<div class="ttc" id="class_hawkes_learning_triggering_kernel_html_a78139e3d04d736fb4d42e0a3d8b4db42"><div class="ttname"><a href="class_hawkes_learning_triggering_kernel.html#a78139e3d04d736fb4d42e0a3d8b4db42">HawkesLearningTriggeringKernel::Initialize</a></div><div class="ttdeci">void Initialize(const std::vector&lt; Sequence &gt; &amp;data)</div><div class="ttdoc">Initialize the temporal features arrayK and arrayG from the input sequences. </div><div class="ttdef"><b>Definition:</b> <a href="_hawkes_learning_triggering_kernel_8cc_source.html#l00026">HawkesLearningTriggeringKernel.cc:26</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
