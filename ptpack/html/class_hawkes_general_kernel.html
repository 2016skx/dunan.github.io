<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Multivariate Point Process Package: HawkesGeneralKernel Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Multivariate Point Process Package
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="class_hawkes_general_kernel-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">HawkesGeneralKernel Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="class_hawkes_general_kernel.html" title="HawkesGeneralKernel implements the multivariate Hawkes process with customized triggering kernels...">HawkesGeneralKernel</a> implements the multivariate Hawkes process with customized triggering kernels.  
 <a href="class_hawkes_general_kernel.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="_hawkes_general_kernel_8h_source.html">include/HawkesGeneralKernel.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for HawkesGeneralKernel:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_hawkes_general_kernel.png" usemap="#HawkesGeneralKernel_map" alt=""/>
  <map id="HawkesGeneralKernel_map" name="HawkesGeneralKernel_map">
<area href="class_i_process.html" title="IProcess defines a general interface for each specific point process. " alt="IProcess" shape="rect" coords="0,0,138,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_hawkes_general_kernel_1_1_o_p_t_i_o_n.html">OPTION</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options used to configure the fitting of the general Hawkes Process with customized triggering kernels.  <a href="struct_hawkes_general_kernel_1_1_o_p_t_i_o_n.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a5bf97d961da80cb3d6d3e1249fdb9318"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a5bf97d961da80cb3d6d3e1249fdb9318">Regularizer</a> { <a class="el" href="class_hawkes_general_kernel.html#a5bf97d961da80cb3d6d3e1249fdb9318a6712a3014adb2e3092b2b6573343f864">L1</a>, 
<a class="el" href="class_hawkes_general_kernel.html#a5bf97d961da80cb3d6d3e1249fdb9318af82dbb597ca2f147cf60afb7373c5e7b">L22</a>, 
<a class="el" href="class_hawkes_general_kernel.html#a5bf97d961da80cb3d6d3e1249fdb9318a44807e69cc269111e9392a04b5fb3ed1">NUCLEAR</a>, 
<a class="el" href="class_hawkes_general_kernel.html#a5bf97d961da80cb3d6d3e1249fdb9318a38f3837b1d2e27859feaa4558a2dff79">NONE</a>
 }<tr class="memdesc:a5bf97d961da80cb3d6d3e1249fdb9318"><td class="mdescLeft">&#160;</td><td class="mdescRight">Supported regularizations used to fit the standard Hawkes Process.  <a href="class_hawkes_general_kernel.html#a5bf97d961da80cb3d6d3e1249fdb9318">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a5bf97d961da80cb3d6d3e1249fdb9318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada76bb9b6d00ddaa03af7f56c8cbdb5f"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#ada76bb9b6d00ddaa03af7f56c8cbdb5f">RegCoef</a> { <a class="el" href="class_hawkes_general_kernel.html#ada76bb9b6d00ddaa03af7f56c8cbdb5fa69cd6eca0d1d77f8252e94c0e1916b93">LAMBDA0</a>, 
<a class="el" href="class_hawkes_general_kernel.html#ada76bb9b6d00ddaa03af7f56c8cbdb5fa3d90aad8e5f66b3c501ab861c97e7785">LAMBDA</a>
 }<tr class="memdesc:ada76bb9b6d00ddaa03af7f56c8cbdb5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Regularization coefficients.  <a href="class_hawkes_general_kernel.html#ada76bb9b6d00ddaa03af7f56c8cbdb5f">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:ada76bb9b6d00ddaa03af7f56c8cbdb5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10c1797e4c10ae59b2767ba55bc1b770"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a10c1797e4c10ae59b2767ba55bc1b770">OptMethod</a> { <a class="el" href="class_hawkes_general_kernel.html#a10c1797e4c10ae59b2767ba55bc1b770ac47a34079cbfe99cfb9bd31ef33b3f4d">SGD</a>, 
<a class="el" href="class_hawkes_general_kernel.html#a10c1797e4c10ae59b2767ba55bc1b770af7bdf3be50e40dbf1abe91defd290aa1">PLBFGS</a>
 }<tr class="memdesc:a10c1797e4c10ae59b2767ba55bc1b770"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optimization algorithms used to fit the standard Hawkes Process.  <a href="class_hawkes_general_kernel.html#a10c1797e4c10ae59b2767ba55bc1b770">More...</a><br /></td></tr>
</td></tr>
<tr class="separator:a10c1797e4c10ae59b2767ba55bc1b770"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a34bf61d094ef0aaedb4544540a2f68b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a34bf61d094ef0aaedb4544540a2f68b5">HawkesGeneralKernel</a> (const unsigned &amp;n, const unsigned &amp;num_dims, const std::vector&lt; std::vector&lt; <a class="el" href="class_triggering_kernel.html">TriggeringKernel</a> * &gt; &gt; &amp;triggeringkernels)</td></tr>
<tr class="memdesc:a34bf61d094ef0aaedb4544540a2f68b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor.  <a href="#a34bf61d094ef0aaedb4544540a2f68b5">More...</a><br /></td></tr>
<tr class="separator:a34bf61d094ef0aaedb4544540a2f68b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a508a0bda9b1a48ba6e057ddf7521ed24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a508a0bda9b1a48ba6e057ddf7521ed24">fit</a> (const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;data, const <a class="el" href="struct_hawkes_general_kernel_1_1_o_p_t_i_o_n.html">OPTION</a> &amp;options)</td></tr>
<tr class="memdesc:a508a0bda9b1a48ba6e057ddf7521ed24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum likelihood estimation for the model parameters.  <a href="#a508a0bda9b1a48ba6e057ddf7521ed24">More...</a><br /></td></tr>
<tr class="separator:a508a0bda9b1a48ba6e057ddf7521ed24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad6687cc41edeb29e1645bcaf1f30e1c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#aad6687cc41edeb29e1645bcaf1f30e1c">NegLoglikelihood</a> (double &amp;objvalue, Eigen::VectorXd &amp;gradient)</td></tr>
<tr class="memdesc:aad6687cc41edeb29e1645bcaf1f30e1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Negative loglikelihood of general Hawkes process.  <a href="#aad6687cc41edeb29e1645bcaf1f30e1c">More...</a><br /></td></tr>
<tr class="separator:aad6687cc41edeb29e1645bcaf1f30e1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0645fd8353d302ff9303aaa05667eb8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#ae0645fd8353d302ff9303aaa05667eb8">Gradient</a> (const unsigned &amp;k, Eigen::VectorXd &amp;gradient)</td></tr>
<tr class="memdesc:ae0645fd8353d302ff9303aaa05667eb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the gradient w.r.t. the model parameters on the k-th sequence.  <a href="#ae0645fd8353d302ff9303aaa05667eb8">More...</a><br /></td></tr>
<tr class="separator:ae0645fd8353d302ff9303aaa05667eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a685a73285e300111842614e91d9213a5"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a685a73285e300111842614e91d9213a5">Intensity</a> (const double &amp;t, const <a class="el" href="class_sequence.html">Sequence</a> &amp;data, Eigen::VectorXd &amp;intensity_dim)</td></tr>
<tr class="memdesc:a685a73285e300111842614e91d9213a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the summation \(\sum_{d=1}^D\lambda^*_d(t)\) of the intensity value \(\lambda^*_d(t)\) of each dimension in a given sequence data at the time t.  <a href="#a685a73285e300111842614e91d9213a5">More...</a><br /></td></tr>
<tr class="separator:a685a73285e300111842614e91d9213a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf33671a6d14f011398ac68f34db9744"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#adf33671a6d14f011398ac68f34db9744">IntensityUpperBound</a> (const double &amp;t, const double &amp;L, const <a class="el" href="class_sequence.html">Sequence</a> &amp;data, Eigen::VectorXd &amp;intensity_upper_dim)</td></tr>
<tr class="memdesc:adf33671a6d14f011398ac68f34db9744"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the upper bound of the summation of the intensity value on each dimension from time t to t + L given the history of past events in sequence data. Let \({\lambda_d^*(t)}\) be the conditional intensity function on the d-th dimension where \(d=1\dotso D\), and num_dims_ = D. This function returns </p><p class="formulaDsp">
\begin{align} \lambda_0^D(t) \geq \sum_{d=1}^D\sup_{\tau\in[t, t + \tau(t)]}\lambda^*_d(\tau), \end{align}
</p>
<p> where the returned value \(\lambda_0^D(t)\) will be used for Ogata's Thinning algorithm.  <a href="#adf33671a6d14f011398ac68f34db9744">More...</a><br /></td></tr>
<tr class="separator:adf33671a6d14f011398ac68f34db9744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebc7c53550fe641346ce0466ce79087c"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#aebc7c53550fe641346ce0466ce79087c">IntensityIntegral</a> (const double &amp;lower, const double &amp;upper, const <a class="el" href="class_sequence.html">Sequence</a> &amp;data)</td></tr>
<tr class="memdesc:aebc7c53550fe641346ce0466ce79087c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the integral of the intensity function \(\int_{a}^b\lambda^*(\tau)d\tau\) where \(a = lower\) and \(b = upper\).  <a href="#aebc7c53550fe641346ce0466ce79087c">More...</a><br /></td></tr>
<tr class="separator:aebc7c53550fe641346ce0466ce79087c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93823d54bdaee35fe7d46859d5fa9422"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a93823d54bdaee35fe7d46859d5fa9422">PredictNextEventTime</a> (const <a class="el" href="class_sequence.html">Sequence</a> &amp;data, const unsigned &amp;num_simulations)</td></tr>
<tr class="memdesc:a93823d54bdaee35fe7d46859d5fa9422"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predict the next event timing by the expectation \(\int_{t_n}^\infty tf^*(t)dt\). Currently, we use the sample average by simulations to approximate the expectation since the conditional density \(f^*(t)\) normally does not have an analytic form.  <a href="#a93823d54bdaee35fe7d46859d5fa9422">More...</a><br /></td></tr>
<tr class="separator:a93823d54bdaee35fe7d46859d5fa9422"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_i_process"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_i_process')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_i_process.html">IProcess</a></td></tr>
<tr class="memitem:a0b865a610181b638ac7debc95dfb1dea inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a0b865a610181b638ac7debc95dfb1dea">IProcess</a> (const unsigned &amp;n, const unsigned &amp;num_dims)</td></tr>
<tr class="memdesc:a0b865a610181b638ac7debc95dfb1dea inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">The constructor.  <a href="#a0b865a610181b638ac7debc95dfb1dea">More...</a><br /></td></tr>
<tr class="separator:a0b865a610181b638ac7debc95dfb1dea inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a0cc4820b4ee2fdf75794c6f4a18b8 inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">const Eigen::VectorXd &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a03a0cc4820b4ee2fdf75794c6f4a18b8">GetParameters</a> ()</td></tr>
<tr class="memdesc:a03a0cc4820b4ee2fdf75794c6f4a18b8 inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the column vector of model parameters.  <a href="#a03a0cc4820b4ee2fdf75794c6f4a18b8">More...</a><br /></td></tr>
<tr class="separator:a03a0cc4820b4ee2fdf75794c6f4a18b8 inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae81f873b019fbdfa20b18af706ce749c inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#ae81f873b019fbdfa20b18af706ce749c">GetNumDims</a> ()</td></tr>
<tr class="memdesc:ae81f873b019fbdfa20b18af706ce749c inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the number of dimensions in the process.  <a href="#ae81f873b019fbdfa20b18af706ce749c">More...</a><br /></td></tr>
<tr class="separator:ae81f873b019fbdfa20b18af706ce749c inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06fef183e9715749b20e9ed79cc3696e inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a06fef183e9715749b20e9ed79cc3696e">SetParameters</a> (const Eigen::VectorXd &amp;v)</td></tr>
<tr class="memdesc:a06fef183e9715749b20e9ed79cc3696e inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the model parameters.  <a href="#a06fef183e9715749b20e9ed79cc3696e">More...</a><br /></td></tr>
<tr class="separator:a06fef183e9715749b20e9ed79cc3696e inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7478104c50c1454e2f7559a7342c56c inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#ae7478104c50c1454e2f7559a7342c56c">PlotIntensityFunction</a> (const <a class="el" href="class_sequence.html">Sequence</a> &amp;data)</td></tr>
<tr class="memdesc:ae7478104c50c1454e2f7559a7342c56c inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plots the intensity functions based on the given sequence. It plots the intensity function and the associated event points up of each dimension in the same figure.  <a href="#ae7478104c50c1454e2f7559a7342c56c">More...</a><br /></td></tr>
<tr class="separator:ae7478104c50c1454e2f7559a7342c56c inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d234bec06e360a239e77cf3d8150a31 inherit pub_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a8d234bec06e360a239e77cf3d8150a31">PlotIntensityFunction</a> (const <a class="el" href="class_sequence.html">Sequence</a> &amp;data, const unsigned &amp;dim_id)</td></tr>
<tr class="memdesc:a8d234bec06e360a239e77cf3d8150a31 inherit pub_methods_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">Plots the intensity function and the associated event points of the dimension dim_id.  <a href="#a8d234bec06e360a239e77cf3d8150a31">More...</a><br /></td></tr>
<tr class="separator:a8d234bec06e360a239e77cf3d8150a31 inherit pub_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a86c6f88567ff529e279797fd0df03eea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a86c6f88567ff529e279797fd0df03eea">Initialize</a> (const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;data)</td></tr>
<tr class="memdesc:a86c6f88567ff529e279797fd0df03eea"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize the temporal features <a class="el" href="class_hawkes_general_kernel.html#a09da7e2ecfc40e5ad8971c6f0f704a6f">arrayK</a> and <a class="el" href="class_hawkes_general_kernel.html#a0840ffd264be55ed89cf425c065d58e4">arrayG</a> from the input sequences  <a href="#a86c6f88567ff529e279797fd0df03eea">More...</a><br /></td></tr>
<tr class="separator:a86c6f88567ff529e279797fd0df03eea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98f76624aff26da26231967f62cf9eb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a98f76624aff26da26231967f62cf9eb3">RestoreOptionToDefault</a> ()</td></tr>
<tr class="memdesc:a98f76624aff26da26231967f62cf9eb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">restore to the default optimization configuration  <a href="#a98f76624aff26da26231967f62cf9eb3">More...</a><br /></td></tr>
<tr class="separator:a98f76624aff26da26231967f62cf9eb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_class_i_process"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_class_i_process')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="class_i_process.html">IProcess</a></td></tr>
<tr class="memitem:aa099f7f40ad6e747422c9a3794cc09d2 inherit pro_methods_class_i_process"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#aa099f7f40ad6e747422c9a3794cc09d2">InitializeDimension</a> (const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;data)</td></tr>
<tr class="separator:aa099f7f40ad6e747422c9a3794cc09d2 inherit pro_methods_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a09da7e2ecfc40e5ad8971c6f0f704a6f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; Eigen::MatrixXd &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a09da7e2ecfc40e5ad8971c6f0f704a6f">arrayK</a></td></tr>
<tr class="memdesc:a09da7e2ecfc40e5ad8971c6f0f704a6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">the temporal features associated with the intensity  <a href="#a09da7e2ecfc40e5ad8971c6f0f704a6f">More...</a><br /></td></tr>
<tr class="separator:a09da7e2ecfc40e5ad8971c6f0f704a6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0840ffd264be55ed89cf425c065d58e4"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Eigen::MatrixXd &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a0840ffd264be55ed89cf425c065d58e4">arrayG</a></td></tr>
<tr class="memdesc:a0840ffd264be55ed89cf425c065d58e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">summation of the integral of the triggering kernels  <a href="#a0840ffd264be55ed89cf425c065d58e4">More...</a><br /></td></tr>
<tr class="separator:a0840ffd264be55ed89cf425c065d58e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2c7ad8be73e348645e68b911c4d2d0b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="class_triggering_kernel.html">TriggeringKernel</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#ae2c7ad8be73e348645e68b911c4d2d0b">triggeringkernels_</a></td></tr>
<tr class="memdesc:ae2c7ad8be73e348645e68b911c4d2d0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">a \(D\) by \(D\) grid of <a class="el" href="class_triggering_kernel.html">triggering-kernels</a>  <a href="#ae2c7ad8be73e348645e68b911c4d2d0b">More...</a><br /></td></tr>
<tr class="separator:ae2c7ad8be73e348645e68b911c4d2d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfad54d0813c2d85cde45bda5e0dadcf"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#acfad54d0813c2d85cde45bda5e0dadcf">observation_window_T_</a></td></tr>
<tr class="memdesc:acfad54d0813c2d85cde45bda5e0dadcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">a column vector of length \(C\) which is the total number of sequences. Each component records the observation window in the respective sequence.  <a href="#acfad54d0813c2d85cde45bda5e0dadcf">More...</a><br /></td></tr>
<tr class="separator:acfad54d0813c2d85cde45bda5e0dadcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1362645f049d4ec7ffb6252d5b24bcbb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_simple_r_n_g.html">SimpleRNG</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a1362645f049d4ec7ffb6252d5b24bcbb">RNG_</a></td></tr>
<tr class="memdesc:a1362645f049d4ec7ffb6252d5b24bcbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">internal implementation for random number generator  <a href="#a1362645f049d4ec7ffb6252d5b24bcbb">More...</a><br /></td></tr>
<tr class="separator:a1362645f049d4ec7ffb6252d5b24bcbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de64c29e177983db50f22f178e4ab4c"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#a2de64c29e177983db50f22f178e4ab4c">num_sequences_</a></td></tr>
<tr class="memdesc:a2de64c29e177983db50f22f178e4ab4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">total number of observed sequences  <a href="#a2de64c29e177983db50f22f178e4ab4c">More...</a><br /></td></tr>
<tr class="separator:a2de64c29e177983db50f22f178e4ab4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb27ed5df7cf83bea370fb0a42eb7748"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_hawkes_general_kernel_1_1_o_p_t_i_o_n.html">OPTION</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_hawkes_general_kernel.html#abb27ed5df7cf83bea370fb0a42eb7748">options_</a></td></tr>
<tr class="memdesc:abb27ed5df7cf83bea370fb0a42eb7748"><td class="mdescLeft">&#160;</td><td class="mdescRight">A configuration object which saves the optimization options.  <a href="#abb27ed5df7cf83bea370fb0a42eb7748">More...</a><br /></td></tr>
<tr class="separator:abb27ed5df7cf83bea370fb0a42eb7748"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_i_process"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_i_process')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_i_process.html">IProcess</a></td></tr>
<tr class="memitem:ad472e6a7545cb935d7e9bfb59a0e551a inherit pro_attribs_class_i_process"><td class="memItemLeft" align="right" valign="top">Eigen::VectorXd&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#ad472e6a7545cb935d7e9bfb59a0e551a">parameters_</a></td></tr>
<tr class="memdesc:ad472e6a7545cb935d7e9bfb59a0e551a inherit pro_attribs_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">A column vector represents all model parameters of the process.  <a href="#ad472e6a7545cb935d7e9bfb59a0e551a">More...</a><br /></td></tr>
<tr class="separator:ad472e6a7545cb935d7e9bfb59a0e551a inherit pro_attribs_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17278704cd4ea4a6cbcf44b0f6ddb625 inherit pro_attribs_class_i_process"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a17278704cd4ea4a6cbcf44b0f6ddb625">num_dims_</a></td></tr>
<tr class="memdesc:a17278704cd4ea4a6cbcf44b0f6ddb625 inherit pro_attribs_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">The total number of dimensions of the process.  <a href="#a17278704cd4ea4a6cbcf44b0f6ddb625">More...</a><br /></td></tr>
<tr class="separator:a17278704cd4ea4a6cbcf44b0f6ddb625 inherit pro_attribs_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67e1222753e90d1f122d1234590c03ff inherit pro_attribs_class_i_process"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_i_process.html#a67e1222753e90d1f122d1234590c03ff">all_timestamp_per_dimension_</a></td></tr>
<tr class="memdesc:a67e1222753e90d1f122d1234590c03ff inherit pro_attribs_class_i_process"><td class="mdescLeft">&#160;</td><td class="mdescRight">all_timestamp_per_dimension_ is a 3-d array where all_timestamp_per_dimension_[c][n][i] records the i-th event on the n-th dimension in the c-th sequence.  <a href="#a67e1222753e90d1f122d1234590c03ff">More...</a><br /></td></tr>
<tr class="separator:a67e1222753e90d1f122d1234590c03ff inherit pro_attribs_class_i_process"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="class_hawkes_general_kernel.html" title="HawkesGeneralKernel implements the multivariate Hawkes process with customized triggering kernels...">HawkesGeneralKernel</a> implements the multivariate Hawkes process with customized triggering kernels. </p>
<p>A multivariate Hawkes Process is a process where the occurrence of an event to a dimension will trigger more events on this dimension and other related dimensions in the near future. The intensity function of each dimension of the Hawkes process is generally defined as the following: </p><p class="formulaDsp">
\begin{align} \lambda^n(t) = \lambda_0^n + \sum_{m=1}^D\alpha_{mn}\sum_{t^m_j &lt; t}\gamma(t - t^m_j), \end{align}
</p>
<p> where \(\lambda_0^n\geq 0\) is the base intensity, \(D\) is the number of dimensions, \(\alpha_{mn}\geq 0\), and the triggering kernel \(\gamma(t - t^m_j)\) captures the extent to which an event on dimension m at the time \(t^m_j\) can trigger an event on dimension n in the near future. Normally, in the <a class="el" href="class_plain_hawkes.html">standard Hawkes process</a>, we have \(\gamma(t - t^m_j) = \exp(-\beta_{mn}(t - t^m_j))\). However, in more general cases, the form of the triggering kernel can be formulated to catpure the phenomena of interest. The collection of \(\{\alpha_{mn}\}\) can be represented as a matrix \(\mathbf{A}(m,n) = \alpha_{mn}\), and the collection of \(\{\lambda_0^n\}\) can be represented as a column vector \(\boldsymbol{\lambda}_0\). </p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00025">25</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a10c1797e4c10ae59b2767ba55bc1b770"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_hawkes_general_kernel.html#a10c1797e4c10ae59b2767ba55bc1b770">HawkesGeneralKernel::OptMethod</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Optimization algorithms used to fit the standard Hawkes Process. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a10c1797e4c10ae59b2767ba55bc1b770ac47a34079cbfe99cfb9bd31ef33b3f4d"></a>SGD&#160;</td><td class="fielddoc">
<p>stochastic gradient descend. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a10c1797e4c10ae59b2767ba55bc1b770af7bdf3be50e40dbf1abe91defd290aa1"></a>PLBFGS&#160;</td><td class="fielddoc">
<p><a href="http://jmlr.csail.mit.edu/proceedings/papers/v5/schmidt09a/schmidt09a.pdf">projected LBFGS</a>. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00125">125</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ada76bb9b6d00ddaa03af7f56c8cbdb5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_hawkes_general_kernel.html#ada76bb9b6d00ddaa03af7f56c8cbdb5f">HawkesGeneralKernel::RegCoef</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Regularization coefficients. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ada76bb9b6d00ddaa03af7f56c8cbdb5fa69cd6eca0d1d77f8252e94c0e1916b93"></a>LAMBDA0&#160;</td><td class="fielddoc">
<p>Regularization coefficient for \(\|\boldsymbol{\lambda}_0\|\) </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ada76bb9b6d00ddaa03af7f56c8cbdb5fa3d90aad8e5f66b3c501ab861c97e7785"></a>LAMBDA&#160;</td><td class="fielddoc">
<p>Regularization coefficient for \(\|\mathbf{A}\|\) </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00111">111</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5bf97d961da80cb3d6d3e1249fdb9318"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="class_hawkes_general_kernel.html#a5bf97d961da80cb3d6d3e1249fdb9318">HawkesGeneralKernel::Regularizer</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Supported regularizations used to fit the standard Hawkes Process. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a5bf97d961da80cb3d6d3e1249fdb9318a6712a3014adb2e3092b2b6573343f864"></a>L1&#160;</td><td class="fielddoc">
<p>Sparse L1 norm \(\|\cdot\|_1\) </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a5bf97d961da80cb3d6d3e1249fdb9318af82dbb597ca2f147cf60afb7373c5e7b"></a>L22&#160;</td><td class="fielddoc">
<p>L22 norm \(\|\cdot\|_2^2\) </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a5bf97d961da80cb3d6d3e1249fdb9318a44807e69cc269111e9392a04b5fb3ed1"></a>NUCLEAR&#160;</td><td class="fielddoc">
<p>Nuclear norm \(\|\mathbf{A}\|_* = \sum_{i=1}^{\min(m,n)}\sigma_i\) where \(sigma_i\) is the singular value of matrix \(\mathbf{A}\) </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a5bf97d961da80cb3d6d3e1249fdb9318a38f3837b1d2e27859feaa4558a2dff79"></a>NONE&#160;</td><td class="fielddoc">
<p>No regularization </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00090">90</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a34bf61d094ef0aaedb4544540a2f68b5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HawkesGeneralKernel::HawkesGeneralKernel </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>num_dims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; <a class="el" href="class_triggering_kernel.html">TriggeringKernel</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>triggeringkernels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>the number of parameters in total. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_dims</td><td>the number of dimensions in the process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">triggeringkernels</td><td>a D-by-D grid of <a class="el" href="class_triggering_kernel.html">triggering-kernels</a>. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00173">173</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a508a0bda9b1a48ba6e057ddf7521ed24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesGeneralKernel::fit </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_hawkes_general_kernel_1_1_o_p_t_i_o_n.html">OPTION</a> &amp;&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum likelihood estimation for the model parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>vectors of observed sequences. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>data structure sotring different configuration for the optimization algorithm and the respective regularizations. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8cc_source.html#l00070">70</a> of file <a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ae0645fd8353d302ff9303aaa05667eb8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesGeneralKernel::Gradient </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the gradient w.r.t. the model parameters on the k-th sequence. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">k</td><td>sequence index. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gradient</td><td>the gradient vector w.r.t. the model parameters. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_i_process.html#a7bf5acfa8aaebde465184f99f8fa5f3f">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8cc_source.html#l00189">189</a> of file <a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a86c6f88567ff529e279797fd0df03eea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesGeneralKernel::Initialize </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="class_sequence.html">Sequence</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>initialize the temporal features <a class="el" href="class_hawkes_general_kernel.html#a09da7e2ecfc40e5ad8971c6f0f704a6f">arrayK</a> and <a class="el" href="class_hawkes_general_kernel.html#a0840ffd264be55ed89cf425c065d58e4">arrayG</a> from the input sequences </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>input collection of sequences </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8cc_source.html#l00017">17</a> of file <a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a685a73285e300111842614e91d9213a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double HawkesGeneralKernel::Intensity </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>intensity_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the summation \(\sum_{d=1}^D\lambda^*_d(t)\) of the intensity value \(\lambda^*_d(t)\) of each dimension in a given sequence data at the time t. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>the given time. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>the given sequence of the past events until time t. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">intensity_dim</td><td>a column vector of size num_dims_ where each component stores the intensity value of the respetive dimension at time t given the past sequence in data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the summation of the intensity value from each dimension. </dd></dl>

<p>Implements <a class="el" href="class_i_process.html#a1a95cb173cd1382b0a2b02be40eff726">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8cc_source.html#l00196">196</a> of file <a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aebc7c53550fe641346ce0466ce79087c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double HawkesGeneralKernel::IntensityIntegral </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>lower</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>upper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the integral of the intensity function \(\int_{a}^b\lambda^*(\tau)d\tau\) where \(a = lower\) and \(b = upper\). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lower</td><td>starting point of the integral. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">upper</td><td>ending point of the integral. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>sequence of past events. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>\(\int_{a}^b\lambda^*(\tau)d\tau\) where \(a = lower\) and \(b = upper\). </dd></dl>

<p>Implements <a class="el" href="class_i_process.html#a4a07c03f4627adbf5f56f1305865648a">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8cc_source.html#l00266">266</a> of file <a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="adf33671a6d14f011398ac68f34db9744"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double HawkesGeneralKernel::IntensityUpperBound </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>intensity_upper_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the upper bound of the summation of the intensity value on each dimension from time t to t + L given the history of past events in sequence data. Let \({\lambda_d^*(t)}\) be the conditional intensity function on the d-th dimension where \(d=1\dotso D\), and num_dims_ = D. This function returns </p><p class="formulaDsp">
\begin{align} \lambda_0^D(t) \geq \sum_{d=1}^D\sup_{\tau\in[t, t + \tau(t)]}\lambda^*_d(\tau), \end{align}
</p>
<p> where the returned value \(\lambda_0^D(t)\) will be used for Ogata's Thinning algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>the starting time. </td></tr>
    <tr><td class="paramname">L</td><td>the duration. </td></tr>
    <tr><td class="paramname">data</td><td>the given sequence of the past events until time t. </td></tr>
    <tr><td class="paramname">intensity_upper_dim</td><td>a column vector of size num_dims_ storing the upper bound of the intensity function on each dimension from time t to t + L. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the summation of the upper-bound of each intensity function from the respetive dimension within the interval [t, t + L]. </dd></dl>

<p>Implements <a class="el" href="class_i_process.html#ac70ce447b3cc124827737eefe526013d">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8cc_source.html#l00231">231</a> of file <a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="aad6687cc41edeb29e1645bcaf1f30e1c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesGeneralKernel::NegLoglikelihood </td>
          <td>(</td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>objvalue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>gradient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Negative loglikelihood of general Hawkes process. </p>
<p class="formulaDsp">
\begin{align} -\sum_{n=1}^D\bigg\{\frac{1}{C}\sum_{c=1}^C\bigg(\sum_{i = 1}^{n_c}\bigg(\log(\lambda^n_0 + \sum_{m=1}^D\alpha_{mn}\underbrace{\sum_{t^m_{i,c}&lt;t^n_{i,c}}\gamma_{mn}(t^n_{i,c} - t^m_{i,c})}_{\text{arrayK[n][c](i,m)}})\bigg) - T_c\lambda_0^n - \sum_{m=1}^D\alpha_{mn}\underbrace{\sum_{t^m_{j,c} &lt; T_c}\int_{t^m_j}^{T_c}\gamma_{mn}(t - t^m_{j,c})dt)}_{\text{arrayG[n](c,m)}}\bigg)\bigg\}. \end{align}
</p>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">objvalue</td><td>negative loglikelihood. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">gradient</td><td>gradient of the parameters. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="class_i_process.html#afc330025b3eec10ffcbfbb1c658445d3">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8cc_source.html#l00083">83</a> of file <a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a93823d54bdaee35fe7d46859d5fa9422"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double HawkesGeneralKernel::PredictNextEventTime </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_sequence.html">Sequence</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>num_simulations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Predict the next event timing by the expectation \(\int_{t_n}^\infty tf^*(t)dt\). Currently, we use the sample average by simulations to approximate the expectation since the conditional density \(f^*(t)\) normally does not have an analytic form. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>the sequence of past events. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_simulations</td><td>number of simulations we use to calculate the sample average. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the prediction of the next event timing. </dd></dl>

<p>Implements <a class="el" href="class_i_process.html#aaf94ce20c93b91a79d4e31260ce884ed">IProcess</a>.</p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8cc_source.html#l00309">309</a> of file <a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a98f76624aff26da26231967f62cf9eb3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void HawkesGeneralKernel::RestoreOptionToDefault </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>restore to the default optimization configuration </p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8cc_source.html#l00321">321</a> of file <a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a0840ffd264be55ed89cf425c065d58e4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Eigen::MatrixXd&gt; HawkesGeneralKernel::arrayG</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>summation of the integral of the triggering kernels </p>
<p>The log-likelihood of observing a collection of C sequences can be derived as the following: </p><p class="formulaDsp">
\begin{align} \sum_{n=1}^D\bigg\{\frac{1}{C}\sum_{c=1}^C\bigg(\sum_{i = 1}^{n_c}\bigg(\log(\lambda^n_0 + \sum_{m=1}^D\alpha_{mn}\underbrace{\sum_{t^m_{i,c}&lt;t^n_{i,c}}\gamma_{mn}(t^n_{i,c} - t^m_{i,c})}_{\text{arrayK[n][c](i,m)}})\bigg) - T_c\lambda_0^n - \sum_{m=1}^D\alpha_{mn}\underbrace{\sum_{t^m_{j,c} &lt; T_c}\int_{t^m_j}^{T_c}\gamma_{mn}(t - t^m_{j,c})dt)}_{\text{arrayG[n](c,m)}}\bigg)\bigg\}. \end{align}
</p>
<p>arrayG[n] is an \(C\) by \(D\) matrix where \(n_c\) is the number of events on the nth dimension in the sequence c. arrayK[n][c](i,m) stores the cumulative influence of the past events on dimension \(m\) in the sequence \(c\) to the occurence of the \(i\)th event on dimension \(n\). </p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00052">52</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a09da7e2ecfc40e5ad8971c6f0f704a6f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;Eigen::MatrixXd&gt; &gt; HawkesGeneralKernel::arrayK</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the temporal features associated with the intensity </p>
<p>The log-likelihood of observing a collection of C sequences can be derived as the following: </p><p class="formulaDsp">
\begin{align} \sum_{n=1}^D\bigg\{\frac{1}{C}\sum_{c=1}^C\bigg(\sum_{i = 1}^{n_c}\bigg(\log(\lambda^n_0 + \sum_{m=1}^D\alpha_{mn}\underbrace{\sum_{t^m_{j,c}&lt;t^n_{i,c}}\gamma_{mn}(t^n_{i,c} - t^m_{j,c})}_{\text{arrayK[n][c](i,m)}})\bigg) - T_c\lambda_0^n - \sum_{m=1}^D\alpha_{mn}\underbrace{\sum_{t^m_{j,c} &lt; T_c}\int_{t^m_j}^{T_c}\gamma_{mn}(t - t^m_{j,c})dt)}_{\text{arrayG[n](c,m)}}\bigg)\bigg\}. \end{align}
</p>
<p>arrayK[n][c] is an \(n_c\) by \(D\) matrix where \(n_c\) is the number of events on the nth dimension in the sequence c. arrayK[n][c](i,m) stores the cumulative influence of the past events on dimension \(m\) in the sequence \(c\) to the occurence of the \(i\)th event on dimension \(n\). </p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00040">40</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2de64c29e177983db50f22f178e4ab4c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned HawkesGeneralKernel::num_sequences_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>total number of observed sequences </p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00073">73</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="acfad54d0813c2d85cde45bda5e0dadcf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Eigen::VectorXd HawkesGeneralKernel::observation_window_T_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>a column vector of length \(C\) which is the total number of sequences. Each component records the observation window in the respective sequence. </p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00063">63</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="abb27ed5df7cf83bea370fb0a42eb7748"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_hawkes_general_kernel_1_1_o_p_t_i_o_n.html">OPTION</a> HawkesGeneralKernel::options_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A configuration object which saves the optimization options. </p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00163">163</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1362645f049d4ec7ffb6252d5b24bcbb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_simple_r_n_g.html">SimpleRNG</a> HawkesGeneralKernel::RNG_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>internal implementation for random number generator </p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00068">68</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<a class="anchor" id="ae2c7ad8be73e348645e68b911c4d2d0b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;<a class="el" href="class_triggering_kernel.html">TriggeringKernel</a>*&gt; &gt; HawkesGeneralKernel::triggeringkernels_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>a \(D\) by \(D\) grid of <a class="el" href="class_triggering_kernel.html">triggering-kernels</a> </p>

<p>Definition at line <a class="el" href="_hawkes_general_kernel_8h_source.html#l00058">58</a> of file <a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/Users/nandu/Development/MultiVariatePointProcess/include/<a class="el" href="_hawkes_general_kernel_8h_source.html">HawkesGeneralKernel.h</a></li>
<li>/Users/nandu/Development/MultiVariatePointProcess/src/<a class="el" href="_hawkes_general_kernel_8cc_source.html">HawkesGeneralKernel.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
